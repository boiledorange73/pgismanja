<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>第10章 PostGISラスタ よくある質問</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="PostGIS 2.3.0 マニュアル"><link rel="up" href="index.html" title="PostGIS 2.3.0 マニュアル"><link rel="prev" href="RT_ST_DFullyWithin.html" title="ST_DFullyWithin"><link rel="next" href="Topology.html" title="第11章 トポロジ"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第10章 PostGISラスタ よくある質問</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="RT_ST_DFullyWithin.html">戻る</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="Topology.html">次へ</a></td></tr></table><hr></div><div class="chapter" title="第10章 PostGISラスタ よくある質問"><div class="titlepage"><div><div><h2 class="title"><a name="RT_FAQ"></a>第10章 PostGISラスタ よくある質問</h2></div></div></div><div class="qandaset" title="よくある質問"><a name="idp99940560"></a><dl><dt>10.1. <a href="RT_FAQ.html#faq_security_change_1">ST_FromGDALRasterを使うとERROR: RASTER_fromGDALRaster: Could not open bytea with GDAL. Check that the bytea is of a GDAL supported format.というエラーが出ます。また、ST_AsPNGや他の入力関数を使おうとするとERROR: rt_raster_to_gdal: Could not load the output GDAL driverというエラーが出ます。</a></dt><dt>10.2. <a href="RT_FAQ.html#idp99944656">PostGISラスタプロジェクトに関するより多くの情報はどこにありますか?</a></dt><dt>10.3. <a href="RT_FAQ.html#idp99971664">この素晴らしいものを始めるための書籍やチュートリアルはありますか?</a></dt><dt>10.4. <a href="RT_FAQ.html#idp99976528">PostGISデータベースにラスタ機能をインストールするにはどうすればよいでしょうか?</a></dt><dt>10.5. <a href="RT_FAQ.html#idp99982416">"C:/Program Files/PostgreSQL/8.4/lib/rtpostgis.dll": The specified module could not be found.エラーがでました。また、Linux上でrtpostgis.sql実行時にライブラリのロードができませんでした。</a></dt><dt>10.6. <a href="RT_FAQ.html#idp99984720">ラスタデータをPostGISにロードするにはどうすればよいでしょうか?</a></dt><dt>10.7. <a href="RT_FAQ.html#idp99988048">ロード可能なラスタファイルの種類は何ですか?</a></dt><dt>10.8. <a href="RT_FAQ.html#idp99991376">PostGISラスタデータを他のラスタ形式に出力できますか?</a></dt><dt>10.9. <a href="RT_FAQ.html#idp100001232">GDALバイナリはPostGISラスタ機能付きでコンパイルされていますか?</a></dt><dt>10.10. <a href="RT_FAQ.html#idp100005200">PostGISラスタデータを見るのに使うことができるツールは何ですか?</a></dt><dt>10.11. <a href="RT_FAQ.html#idp100008016">MapServerの地図にPostGISラスタレイヤを追加するにはどうすればいいですか?</a></dt><dt>10.12. <a href="RT_FAQ.html#idp100013264">現在ラスタデータで使用できる関数は何ですか?</a></dt><dt>10.13. <a href="RT_FAQ.html#qa_raster_function_not_unique">「ERROR: function st_intersects(raster, unknown) is not unique or st_union(geometry,text) is not unique.」というエラーが出ました。解消するにはどうすればいいでしょうか?</a></dt><dt>10.14. <a href="RT_FAQ.html#idp100020176">PostGISラスタとOracle GeoRaster (SDO_GEORATGER)およびSDO_RASTERとどの位違うのでしょうか?</a></dt><dt>10.15. <a href="RT_FAQ.html#qa_raster_fails_encoding_conversion">raster2pgsqlにより巨大なファイルのロードがString of N bytes is too long for encoding conversionと言われて失敗しますがどうすればよいでしょうか?</a></dt></dl><table border="0" width="100%" summary="Q and A Set"><col align="left" width="1%"><col><tbody><tr class="question" title="10.1."><td align="left" valign="top"><a name="faq_security_change_1"></a><a name="idp99941200"></a><p><b>10.1.</b></p></td><td align="left" valign="top"><p>ST_FromGDALRasterを使うと<code class="code">ERROR: RASTER_fromGDALRaster: Could not open bytea with GDAL. Check that the bytea is of a GDAL supported format.</code>というエラーが出ます。また、ST_AsPNGや他の入力関数を使おうとすると<code class="code">ERROR: rt_raster_to_gdal: Could not load the output GDAL driver</code>というエラーが出ます。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>As of PostGIS 2.1.3 and 2.0.5, a security change was made to by default disable all GDAL drivers and out of db rasters. The release notes are at <a class="ulink" href="http://postgis.net/2014/05/19/postgis-2.0.6_and_2.1.3" target="_top">PostGIS 2.0.6, 2.1.3 security release</a>. In order to reenable specific drivers or all drivers and reenable out of database support, refer to <a class="xref" href="postgis_installation.html#install_short_version" title="2.1. 簡略版">「簡略版」</a>.</p></td></tr><tr class="question" title="10.2."><td align="left" valign="top"><a name="idp99944656"></a><a name="idp99944912"></a><p><b>10.2.</b></p></td><td align="left" valign="top"><p>PostGISラスタプロジェクトに関するより多くの情報はどこにありますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><a class="ulink" href="http://trac.osgeo.org/postgis/wiki/WKTRaster" target="_top">PostGIS Raster home page</a>をご覧下さい。</p></td></tr><tr class="question" title="10.3."><td align="left" valign="top"><a name="idp99971664"></a><a name="idp99971920"></a><p><b>10.3.</b></p></td><td align="left" valign="top"><p>この素晴らしいものを始めるための書籍やチュートリアルはありますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>There is a full length beginner tutorial <a class="ulink" href="http://trac.osgeo.org/postgis/wiki/WKTRasterTutorial01" target="_top"> Intersecting vector buffers with large raster coverage using PostGIS Raster</a>. Jorge has a series of blog articles on PostGIS Raster that demonstrate how to load raster data as well as cross compare to same tasks in Oracle GeoRaster. Check out <a class="ulink" href="http://gis4free.wordpress.com/category/postgis-raster/" target="_top">Jorge's PostGIS Raster / Oracle GeoRaster Series</a>. There is a whole chapter (more than 35 pages of content) dedicated to PostGIS Raster with free code and data downloads at <a class="ulink" href="https://www.manning.com/books/postgis-in-action-second-edition" target="_top">PostGIS in Action - Raster chapter</a>. You can <a class="ulink" href="http://www.postgis.us/page_buy_book" target="_top">buy PostGIS in Action</a> now from Manning in hard-copy (significant discounts for bulk purchases) or just the E-book format. You can also buy from Amazon and various other book distributors. All hard-copy books come with a free coupon to download the E-book version. </p><p>Here is a review from a PostGIS Raster user <a class="ulink" href="http://fuzzytolerance.info/blog/2010/10/25/2010-10-26-postgis-raster-ftw/" target="_top">PostGIS raster applied to land classification urban forestry</a></p></td></tr><tr class="question" title="10.4."><td align="left" valign="top"><a name="idp99976528"></a><a name="idp99976784"></a><p><b>10.4.</b></p></td><td align="left" valign="top"><p>PostGISデータベースにラスタ機能をインストールするにはどうすればよいでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>PostGISとラスタ機能のバイナリをダウンロードするのが最も簡単です。Windows用と最新のMacOS X用とがあります。まずPostGIS 2.0.0以上とPostgreSQL 8.4, 9.0 または 9.1 が動作している必要があります。PostGIS 2.0ではPostGISラスタは完全に統合されていて、PostGISをコンパイルするときにPostGISラスタはコンパイルされます。</p><p>Windows下でのインストールと実行の説明は<a class="ulink" href="http://gis4free.wordpress.com/2011/03/10/how-to-install-and-configure-postgis-raster-on-windows/" target="_top">How to Install and Configure PostGIS raster on windows</a>にあります。</p><p>Windows下でコンパイルすることができますし、<a class="ulink" href="http://postgis.net/windows_downloads" target="_top">コンパイル済みPostGISラスタのバイナリ</a>を使うこともできます。MacOS X LeopardまたはSnow Leopardでは、<a class="ulink" href="http://www.kyngchaos.com/software/postgres" target="_top">Kyng Chaos Mac OSX PostgreSQL/GIS binaries</a>バイナリがあります。 </p><p>データベースでラスタサポートを有効にするにはrtpostgis.sqlファイルをデータベースで実行します。既存のラスタサポートのアップグレードではrtpostgis_upgrade_minor..sqlを実行します。</p><p>他のプラットフォームでは、一般的には、自分でコンパイルする必要があります。依存物はPostGISとGDALです。ソースからのコンパイルの詳細については<a class="ulink" href="http://trac.osgeo.org/postgis/wiki/WKTRaster/Documentation01#a2.3-CompilingandInstallingfromSources" target="_top">Installing PostGIS Raster from source (以前の版のPostGIS)</a>をご覧ください。</p></td></tr><tr class="question" title="10.5."><td align="left" valign="top"><a name="idp99982416"></a><a name="idp99982672"></a><p><b>10.5.</b></p></td><td align="left" valign="top"><p>"C:/Program Files/PostgreSQL/8.4/lib/rtpostgis.dll": The specified module could not be found.エラーがでました。また、Linux上でrtpostgis.sql実行時にライブラリのロードができませんでした。</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>rtpostgis.dll/soは、libgdal.dll/soに依存します。Windowsではlibgdal-1.dllをPostgreSQLインストール先のbinフォルダに置いてください。Linuxについてはlibgdalがパスまたはbinフォルダの中に置いて下さい。 </p><p>また、PostGISをデータベースにインストールしていない場合には別のエラーが出ます。PostGISをまずデータベースにインストールしてから、ラスタ機能をインストールしてみてください。</p></td></tr><tr class="question" title="10.6."><td align="left" valign="top"><a name="idp99984720"></a><a name="idp99984976"></a><p><b>10.6.</b></p></td><td align="left" valign="top"><p>ラスタデータをPostGISにロードするにはどうすればよいでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>PostGIS最新版には、ラスタローダ<code class="varname">raster2pgsql</code>があります。多種のラスタのロードが可能で、低解像度のオーバビューを作成することが可能な実行可能ファイルで、他のソフトウェアを要しません。詳細情報については<a class="xref" href="using_raster_dataman.html#RT_Raster_Loader" title="5.1.1. raster2pgsqlを使ってラスタをロードする">「raster2pgsqlを使ってラスタをロードする」</a>を参照して下さい。2.0版より前では <code class="varname">raster2pgsql.py</code>がありましたが、numpyとGDALに対応したPythonが必要でしたが、現版では必要ありません。</p></td></tr><tr class="question" title="10.7."><td align="left" valign="top"><a name="idp99988048"></a><a name="idp99988304"></a><p><b>10.7.</b></p></td><td align="left" valign="top"><p>ロード可能なラスタファイルの種類は何ですか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>GDALライブラリがサポートするもの全てです。GDALがサポートする形式については<a class="ulink" href="http://www.gdal.org/formats_list.html" target="_top">GDAL File Formats</a>にあります。</p><p>インストールで、一部の形式に対応していない可能性があります。インストールしたGDALがサポートする形式を確認するには、次を実行してください。</p><pre class="programlisting">raster2pgsql -G</pre></td></tr><tr class="question" title="10.8."><td align="left" valign="top"><a name="idp99991376"></a><a name="idp99991632"></a><p><b>10.8.</b></p></td><td align="left" valign="top"><p>PostGISラスタデータを他のラスタ形式に出力できますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>はい</p><p>GDAL 1.7以上にはPostGISラスタのドライバがあります。ただしPostgreSQLサポートを付けてコンパイルするようにした場合に限ります。 </p><p>PostGISラスタ型に不規則なブロックのラスタを格納できますが、GDALドライバは現在のところ不規則なブロックのラスタには対応していません。</p><p>ソースからコンパイルする場合、ドライバを有効にするには、コンフィギュアに</p><pre class="programlisting">--with-pg=path/to/pg_config</pre><p>を入れる必要があります。まざまなプラットフォーム上でGDALをビルドする際の各種情報については、<a class="ulink" href="http://trac.osgeo.org/gdal/wiki/BuildHints" target="_top">GDAL Build Hints</a>を参照して下さい。 </p><p>GDALをPostGISラスタドライバ付きでコンパイルしているなら、次のコマンドを実行すると、リストにPostGIS Rasterが現れます。 </p><pre class="programlisting">gdalinfo --formats</pre><p>GDALからラスタに関する要約を得るには、gdalinfoを使います。 </p><pre class="programlisting">gdalinfo  "PG:host=localhost port=5432 dbname='mygisdb' user='postgres' password='whatever' schema='someschema' table=sometable"</pre><p>
		 </p><p>他のラスタ書式へデータを出力するには、gdal_translateを使います。下で示すものは、テーブルからのデータ全体を10%のサイズのPNGファイルにして出力します。</p><p>ピクセルバンドタイプについて、出力書式がサポートしない場合は、変換が機能しないことがあります。たとえば、浮動小数点数と32ビット符号なし整数は、JPGや他の書式に簡単には変換しません。</p><p>次に単純な変換の例を示します。</p><pre class="programlisting">gdal_translate -of PNG -outsize 10% 10% "PG:host=localhost port=5432 dbname='mygisdb' user='postgres' password='whatever' schema='someschema' table=sometable" C:\somefile.png</pre><p>また、ドライバ接続文字列内でwhere=...を使って、SQLのWHERE節を使うことができます。次に例を示します。</p><pre class="programlisting">gdal_translate -of PNG -outsize 10% 10% "PG:host=localhost port=5432 dbname='mygisdb' user='postgres' password='whatever' schema='someschema' table=sometable where='filename=\'abcd.sid\''" " C:\somefile.png</pre><pre class="programlisting">gdal_translate -of PNG -outsize 10% 10% "PG:host=localhost port=5432 dbname='mygisdb' user='postgres' password='whatever' schema='someschema' table=sometable where='ST_Intersects(rast, ST_SetSRID(ST_Point(-71.032,42.3793),4326) )' " C:\intersectregion.png</pre><p>より多くの例、構文については<a class="ulink" href="http://trac.osgeo.org/gdal/wiki/frmts_wtkraster.html#a3.2-Readingrasterdatafromthedatabase" target="_top">Reading Raster Data of PostGIS Raster section</a>を参照してください。</p></td></tr><tr class="question" title="10.9."><td align="left" valign="top"><a name="idp100001232"></a><a name="idp100001488"></a><p><b>10.9.</b></p></td><td align="left" valign="top"><p>GDALバイナリはPostGISラスタ機能付きでコンパイルされていますか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>はい。<a class="ulink" href="http://trac.osgeo.org/gdal/wiki/DownloadingGdalBinaries" target="_top">GDAL Binaries</a>のページをご覧下さい。PostgreSQL対応でコンパイルされているものはPostGISラスタを持っています。 </p><p>PostGIS Raster is undergoing many changes. If you want to get the latest nightly build for Windows -- then check out the Tamas Szekeres nightly builds built with Visual Studio which contain GDAL trunk, Python Bindings and MapServer executables and PostGIS Raster driver built-in. Just click the SDK bat and run your commands from there. <a class="ulink" href="www.gisinternals.com" target="_top">http://www.gisinternals.com</a>. Also available are VS project files.</p><p><a class="ulink" href="http://fwtools.maptools.org/" target="_top">Windows用FWTools最新の安定版はラスタサポート付きでコンパイルされています</a>。</p></td></tr><tr class="question" title="10.10."><td align="left" valign="top"><a name="idp100005200"></a><a name="idp100005456"></a><p><b>10.10.</b></p></td><td align="left" valign="top"><p>PostGISラスタデータを見るのに使うことができるツールは何ですか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>GDAL 1.7以上とPostGISラスタドライバサポートとを付けてコンパイルしたMapServerでラスタデータの閲覧に使うことが可能です。QuantumGIS (QGIS) では、現在は、PostGISラスタドライバをインストールすると、PostGISラスタの閲覧が可能です。</p><p>In theory any tool that renders data using GDAL can support PostGIS raster data or support it with fairly minimal effort. Again for Windows, Tamas' binaries <a class="ulink" href="www.gisinternals.com" target="_top">http://www.gisinternals.com</a> are a good choice if you don't want the hassle of having to setup to compile your own.</p></td></tr><tr class="question" title="10.11."><td align="left" valign="top"><a name="idp100008016"></a><a name="idp100008272"></a><p><b>10.11.</b></p></td><td align="left" valign="top"><p>MapServerの地図にPostGISラスタレイヤを追加するにはどうすればいいですか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>まずGDAL 1.7以上をPostGISラスタサポート付きでコンパイルします。多数の問題が1.8で解消したので、GDAL 1.8以上が望ましいです。また、より多くのPostGISラスタの問題は開発中の版で解消しています。</p><p>他のラスタでできることと同じことができます。MapServerラスタレイヤで使うことができる様々な処理機能のリストを得るには<a class="ulink" href="http://mapserver.org/input/raster.html" target="_top">MapServer Raster processing options</a>を参照して下さい。</p><p>PostGISラスタデータを特に興味深くするのは、それぞれのタイルが様々な標準的なデータベースカラムを持ち得るので、データソースで分割することができる点です。</p><p>次に示す例は、PostGISラスタレイヤをMapServer内で定義する方法です。</p><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>mode=2 では、タイル化されたラスタが求められるもので、PostGIS 2.0とGDAL 1.8ドライバで追加されています。これはGDAL 1.7ドライバにはありません。</p></td></tr></table></div><pre class="programlisting">-- 標準的なラスタオプションでラスタを表示します
LAYER
        NAME coolwktraster
        TYPE raster
        STATUS ON
        DATA "PG:host=localhost port=5432 dbname='somedb' user='someuser' password='whatever' 
                schema='someschema' table='cooltable' mode='2'"        
        PROCESSING "NODATA=0"
        PROCESSING "SCALE=AUTO"
        #... other standard raster processing functions here
        #... classes are optional but useful for 1 band data
        CLASS
                NAME "boring"
                EXPRESSION ([pixel] &lt; 20)
                COLOR 250 250 250
        END
        CLASS
                NAME "mildly interesting"
                EXPRESSION ([pixel] &gt; 20 AND [pixel] &lt; 1000)
                COLOR 255 0 0
        END
        CLASS
                NAME "very interesting"
                EXPRESSION ([pixel] &gt;= 1000)
                COLOR 0 255 0
        END
END
        </pre><pre class="programlisting">-- 標準的なラスタオプションとWHERE節でラスタを表示します
LAYER
        NAME soil_survey2009
        TYPE raster
        STATUS ON
        DATA "PG:host=localhost port=5432 dbname='somedb' user='someuser' password='whatever' 
                schema='someschema' table='cooltable' where='survey_year=2009' mode='2'"        
        PROCESSING "NODATA=0"
        #... 他の標準的なラスタ処理機能がここに入ります
        #... CLASSは必須ではありませんが1バンドデータには便利です
END
        </pre></td></tr><tr class="question" title="10.12."><td align="left" valign="top"><a name="idp100013264"></a><a name="idp100013520"></a><p><b>10.12.</b></p></td><td align="left" valign="top"><p>現在ラスタデータで使用できる関数は何ですか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p><a class="xref" href="RT_reference.html" title="第9章 ラスタ リファレンス">9章<i>ラスタ リファレンス</i></a>のリストを参照して下さい。これよりも多くの関数がありますが、開発途中です。</p><p>将来的に期待できる関数の詳細情報については<a class="ulink" href="http://trac.osgeo.org/postgis/wiki/WKTRaster/PlanningAndFunding" target="_top">PostGIS Raster roadmap page</a>をご覧下さい。</p></td></tr><tr class="question" title="10.13."><td align="left" valign="top"><a name="qa_raster_function_not_unique"></a><a name="idp100016720"></a><p><b>10.13.</b></p></td><td align="left" valign="top"><p>「ERROR: function st_intersects(raster, unknown) is not unique or st_union(geometry,text) is not unique.」というエラーが出ました。解消するにはどうすればいいでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>引数のひとつがジオメトリでなくジオメトリの文字列表現である場合、一意でない関数エラーが発生します。この場合、PostgreSQLは文字列表現を未知の型とします。そうするとst_intersects(raster, geometry)かst_intersects(raster,raster)かのどちらかになります。理論上両方の関数はリクエストに沿うので、一意でないことになります。これを回避するには、GEOMETRY型にキャストして下さい。</p><p>たとえば次のようになっているとします。</p><pre class="programlisting">SELECT rast
 FROM my_raster
   WHERE ST_Intersects(rast, 'SRID=4326;POINT(-10 10)');</pre><p>次の通りにコードを変更すれば文字列表現をジオメトリにキャストします。</p><pre class="programlisting">SELECT rast
 FROM my_raster
   WHERE ST_Intersects(rast, 'SRID=4326;POINT(-10 10)'::geometry);</pre></td></tr><tr class="question" title="10.14."><td align="left" valign="top"><a name="idp100020176"></a><a name="idp100020432"></a><p><b>10.14.</b></p></td><td align="left" valign="top"><p>PostGISラスタとOracle GeoRaster (SDO_GEORATGER)およびSDO_RASTERとどの位違うのでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>この話題に関するより広範囲な議論については、Jorge Arévaloさんの<a class="ulink" href="http://gis4free.wordpress.com/2010/07/19/oracle-georaster-part-i/" target="_top">Oracle GeoRaster and PostGIS Raster: First impressions </a>をご覧ください。</p><p>ラスタごとのジオリファレンスがレイヤごとのジオリファレンスより優れいていることの主たるものは次の通りです。</p><p>* カバレッジが必ずしも長方形でなくてよいこと (この長方形はしばしば広範囲におよぶラスタカバレッジになります。この文書内にある可能なラスタの配置をご覧ください)</p><p>* オーバラップするラスタ (ベクタからラスタへの変換で欠損無く実装できる点で重要) </p><p>これらの配置はOracleでも可能ですが、多数のSDO_RASTERテーブルと関連付けられる複数のSDO_GEORASTERオブジェクトを格納することになります。複雑なカバレッジになると、データベース上の数百のテーブルにおよぶこともあります。PostGISラスタを使うと、似たようなラスタ配置を一つのテーブルで行うことができます。</p><p>PostGISがユーザに隙間やオーバラップの無い長方形ベクタカバレッジ (完全な長方形トポロジのレイヤ)を強制するのに少し似ています。これは、いくつかのアプリケーションにおいては非常に実際的ですが、実際に行うと、ほとんどのカバレッジにとって、現実的でなく望ましくもないことが分かりました。ベクタ構造には、不連続かつ非長方形のカバレッジを格納する柔軟性が必要です。ラスタ構造が同様に利益を受けることについて、私たちは大きな利点であると考えます。 </p></td></tr><tr class="question" title="10.15."><td align="left" valign="top"><a name="qa_raster_fails_encoding_conversion"></a><a name="idp100025040"></a><p><b>10.15.</b></p></td><td align="left" valign="top"><p>raster2pgsqlにより巨大なファイルのロードがString of N bytes is too long for encoding conversionと言われて失敗しますがどうすればよいでしょうか?</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>raster2pgsqlは、ロード用ファイルを生成するときにデータベース接続を行いません。データベースに明示的にデータベースの文字エンコーディングと異なるものを設定している場合には、巨大な (30MB以上)ラスタファイルをロードするときに、<code class="code">bytes is too long for encoding conversion</code>になることがあります。</p><p>これは、一般的には、たとえばデータベースがUTF-8であるのに、Windowsアプリケーションに対応するために、クライアントの文字エンコーディングが<code class="code">WIN1252</code>に設定されている場合に発生します。</p><p>これを回避策するには、ロードする間、クライアントの文字エンコーディングをデータベースと同じにします。明示的な文字エンコーディング設定をスクリプトに入れることで実現できます。たとえば、Windows上では次のようにします。 </p><pre class="programlisting">set PGCLIENTENCODING=UTF8</pre><p>Unix/Linuxの場合には、次のようにします。 </p><pre class="programlisting">export PGCLIENTENCODING=UTF8</pre><p>Goryさんがこの問題の詳細を<a class="ulink" href="http://trac.osgeo.org/postgis/ticket/2209" target="_top">http://trac.osgeo.org/postgis/ticket/2209</a>に記述しています。</p></td></tr></tbody></table></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="RT_ST_DFullyWithin.html">戻る</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="Topology.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">ST_DFullyWithin </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 第11章 トポロジ</td></tr></table></div></body></html>
