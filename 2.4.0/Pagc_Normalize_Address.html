<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Pagc_Normalize_Address文字列のストリート住所を与えると、道路後置辞、前置辞、標準タイプ、番地、ストリート名等を複数フィールドに分解して持つnorm_addy複合型を返します。この関数は、tiger_geocoder同梱のルックアップテーブルだけを使います (Tigerデータは不要です)。住所標準化エクステンションが必要です。</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="PostGIS 2.4.0 マニュアル"><link rel="up" href="Extras.html#Tiger_Geocoder" title="13.1. Tigerジオコーダ"><link rel="prev" href="Normalize_Address.html" title="Normalize_Address"><link rel="next" href="Pprint_Addy.html" title="Pprint_Addy"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Pagc_Normalize_Address文字列のストリート住所を与えると、道路後置辞、前置辞、標準タイプ、番地、ストリート名等を複数フィールドに分解して持つ<code class="varname">norm_addy</code>複合型を返します。この関数は、tiger_geocoder同梱のルックアップテーブルだけを使います (Tigerデータは不要です)。住所標準化エクステンションが必要です。</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="Normalize_Address.html">戻る</a> </td><th width="60%" align="center">13.1. Tigerジオコーダ</th><td width="20%" align="right"> <a accesskey="n" href="Pprint_Addy.html">次へ</a></td></tr></table><hr></div><div class="refentry" title="Pagc_Normalize_Address文字列のストリート住所を与えると、道路後置辞、前置辞、標準タイプ、番地、ストリート名等を複数フィールドに分解して持つnorm_addy複合型を返します。この関数は、tiger_geocoder同梱のルックアップテーブルだけを使います (Tigerデータは不要です)。住所標準化エクステンションが必要です。"><a name="Pagc_Normalize_Address"></a><div class="titlepage"></div><div class="refnamediv"><h2>名前</h2><p>Pagc_Normalize_Address文字列のストリート住所を与えると、道路後置辞、前置辞、標準タイプ、番地、ストリート名等を複数フィールドに分解して持つ<code class="varname">norm_addy</code>複合型を返します。この関数は、tiger_geocoder同梱のルックアップテーブルだけを使います (Tigerデータは不要です)。住所標準化エクステンションが必要です。 — 文字列のストリート住所を与えると、道路後置辞、前置辞、標準タイプ、番地、ストリート名等を複数フィールドに分解して持つ<code class="varname">norm_addy</code>複合型を返します。この関数は、tiger_geocoder同梱のルックアップテーブルだけを使います (Tigerデータは不要です)。住所標準化エクステンションが必要です。</p></div><div class="refsynopsisdiv" title="概要"><h2>概要</h2><div class="funcsynopsis"><p><code class="funcdef">norm_addy <b class="fsfunc">pagc_normalize_address</b>(</code>varchar  <var class="pdparam">in_address</var><code>)</code>;</p></div></div><div class="refsection" title="説明"><a name="idp104153680"></a><h2>説明</h2><p>文字列で住所が与えられると、道路後置辞、前置辞、正規化された種別、番地、ストリート名等をフィールドに分けて持つ<code class="varname">norm_addy</code>複合型を返します。全ての住所を正規化した郵便形式にするジオコーディング処理の第一段階です。ジオコーダに同梱されるもの以外で必要な者はありません。</p><p>この関数は、Tigerジオコーダとともにロードされ、<code class="varname">tiger</code>スキーマに置かれる、種々のpagc_+ルックアップテーブルだけを使うので、Tigerデータや他のデータをダウンロードする必要はありません。略語や別名を<code class="varname">tiger</code>スキーマのルックアップテーブルに追加しなければならない場合もあります。</p><p><code class="varname">tiger</code>スキーマ内に、入力アドレスを正規化するための、多様な制御ルックアップテーブルを使います。</p><p>この関数が返す<code class="varname">norm_addy</code>型オブジェクトのフィールドは、次に示す順序です。()はジオコーダの必須フィールド、[]は任意フィールドです。</p><p>処理と書式について<a class="xref" href="Normalize_Address.html" title="Normalize_Address">Normalize_Address</a>と若干の違いがあります。</p><p>Availability: 2.1.0</p><p><span class="inlinemediaobject"><img src="images/check.png"></span> This method needs address_standardizer extension.</p><p>(address) [predirAbbrev] (streetName) [streetTypeAbbrev] [postdirAbbrev] [internal] [location] [stateAbbrev] [zip]</p><p>住所標準化エクステンションのstandardaddrは、他国の住所への対応 (countryも含む)があるため、norm_addyより若干フィールドが多くなります。standardaddrの、norm_addyと等価なフィールドは次の通りです。</p><p>house_num,predir, name, suftype, sufdir, unit, city, state, postcode</p><p>Enhanced: 2.4.0 norm_addy object includes additional fields zip4 and address_alphanumeric.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><code class="varname">address</code> 整数: 番地</p></li><li class="listitem"><p><code class="varname">predirAbbrev</code> varchar型: N, S, E, W等といった道路の方向前置辞。<code class="varname">direction_lookup</code>テーブルに制御されます。</p></li><li class="listitem"><p><code class="varname">streetName</code> varchar型</p></li><li class="listitem"><p><code class="varname">streetTypeAbbrev</code> varchar型 ストリート種別の短縮名: St, Ave, Cir等。<code class="varname">street_type_lookup</code>テーブルに制御されます。</p></li><li class="listitem"><p><code class="varname">postdirAbbrev</code> varchar型 N, S, E, W等の道路名の方向後置辞。<code class="varname">direction_lookup</code>テーブルに制御されます。</p></li><li class="listitem"><p><code class="varname">internal</code> varchar型 部屋番号といった内部住所。</p></li><li class="listitem"><p><code class="varname">location</code> varchar型 通常は市名や県名です。</p></li><li class="listitem"><p><code class="varname">stateAbbrev</code> varchar型 MA, NY, MI等のような米国の州名の2文字表示です。<code class="varname">state_lookup</code>テーブルに制御されます。</p></li><li class="listitem"><p><code class="varname">zip</code> varchar型 02109等の5桁の数字です。</p></li><li class="listitem"><p><code class="varname">parsed</code> 真偽型 - 住所が正規化処理で整形されたかを示します。normalize_addressは、住所を返す前にこれをTRUEにします。</p></li><li class="listitem"><p><code class="varname">zip</code> varchar型 02109等の5桁の数字です。</p></li><li class="listitem"><p><code class="varname">address_alphanumeric</code> Full street number even if it has alpha characters like 17R. Parsing of this is better using <a class="xref" href="Pagc_Normalize_Address.html" title="Pagc_Normalize_Address文字列のストリート住所を与えると、道路後置辞、前置辞、標準タイプ、番地、ストリート名等を複数フィールドに分解して持つnorm_addy複合型を返します。この関数は、tiger_geocoder同梱のルックアップテーブルだけを使います (Tigerデータは不要です)。住所標準化エクステンションが必要です。">Pagc_Normalize_Address文字列のストリート住所を与えると、道路後置辞、前置辞、標準タイプ、番地、ストリート名等を複数フィールドに分解して持つ<code class="varname">norm_addy</code>複合型を返します。この関数は、tiger_geocoder同梱のルックアップテーブルだけを使います (Tigerデータは不要です)。住所標準化エクステンションが必要です。</a> function. Availability: PostGIS 2.4.0.</p></li></ol></div></div><div class="refsection" title="例"><a name="idp104185552"></a><h2>例</h2><p>単一呼び出しの例を示します。</p><pre class="programlisting">SELECT addy.*
FROM pagc_normalize_address('9000 E ROO ST STE 999, Springfield, CO') AS addy;


 address | predirabbrev | streetname | streettypeabbrev | postdirabbrev | internal  |  location   | stateabbrev | zip | parsed
---------+--------------+------------+------------------+---------------+-----------+-------------+-------------+-----+--------
    9000 | E            | ROO        | ST               |               | SUITE 999 | SPRINGFIELD | CO          |     | t</pre><p>バッチ呼び出しの例です。現在は、postgis_tiger_geocoderはaddress_standardizerを使用しているため、速度の問題があります。うまくいけば、今後解決されることでしょう。
normaddyへのジオコーディングのバッチ処理で速度が必要な場合には、住所標準化エクステンションのstandaridze_address関数を直接呼ぶことで回避できます。<a class="xref" href="Geocode.html" title="Geocode">Geocode</a>で生成されたデータを使う<a class="xref" href="Normalize_Address.html" title="Normalize_Address">Normalize_Address</a>で行っていることと似ています。例を次に示します。</p><pre class="programlisting">WITH g AS (SELECT address, ROW((sa).house_num, (sa).predir, (sa).name
  , (sa).suftype, (sa).sufdir, (sa).unit , (sa).city, (sa).state, (sa).postcode, true)::norm_addy As na
 FROM (SELECT address, standardize_address('tiger.pagc_lex'
       , 'tiger.pagc_gaz'
       , 'tiger.pagc_rules', address) As sa
        FROM addresses_to_geocode) As g)
SELECT address As orig, (g.na).streetname, (g.na).streettypeabbrev
 FROM  g;

 orig                                                |  streetname   | streettypeabbrev
-----------------------------------------------------+---------------+------------------
 529 Main Street, Boston MA, 02129                   | MAIN          | ST
 77 Massachusetts Avenue, Cambridge, MA 02139        | MASSACHUSETTS | AVE
 25 Wizard of Oz, Walaford, KS 99912323              | WIZARD OF     |
 26 Capen Street, Medford, MA                        | CAPEN         | ST
 124 Mount Auburn St, Cambridge, Massachusetts 02138 | MOUNT AUBURN  | ST
 950 Main Street, Worcester, MA 01610                | MAIN          | ST</pre></div><div class="refsection" title="関連情報"><a name="idp104189136"></a><h2>関連情報</h2><p><a class="xref" href="Normalize_Address.html" title="Normalize_Address">Normalize_Address</a>, <a class="xref" href="Geocode.html" title="Geocode">Geocode</a></p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="Normalize_Address.html">戻る</a> </td><td width="20%" align="center"><a accesskey="u" href="Extras.html#Tiger_Geocoder">上に戻る</a></td><td width="40%" align="right"> <a accesskey="n" href="Pprint_Addy.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">Normalize_Address </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> Pprint_Addy</td></tr></table></div></body></html>
