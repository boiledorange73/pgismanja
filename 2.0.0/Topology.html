<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>第11章 トポロジ</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="PostGIS 2.0.0マニュアル日本語訳"><link rel="up" href="index.html" title="PostGIS 2.0.0マニュアル日本語訳"><link rel="prev" href="RT_FAQ.html" title="第10章 PostGISラスタ よくある質問"><link rel="next" href="getfaceedges_returntype.html" title="getfaceedges_returntype"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第11章 トポロジ</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="RT_FAQ.html">戻る</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="getfaceedges_returntype.html">次へ</a></td></tr></table><hr></div><div class="chapter" title="第11章 トポロジ"><div class="titlepage"><div><div><h2 class="title"><a name="Topology"></a>第11章 トポロジ</h2></div></div></div><div class="toc"><p><b>目次</b></p><dl><dt><span class="sect1"><a href="Topology.html#Topology_Types">11.1. トポロジ型</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Domains">11.2. トポロジドメイン</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_ManagementFunctions">11.3. トポロジとTopoGeometryの管理</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Constructors">11.4. トポロジコンストラクタ</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Editing">11.5. トポロジエディタ</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Accessors">11.6. トポロジアクセサ</a></span></dt><dt><span class="sect1"><a href="Topology.html#Topology_Processing">11.7. トポロジ処理</a></span></dt><dt><span class="sect1"><a href="Topology.html#TopoGeometry_Constructors">11.8. TopoGeometryコンストラクタ</a></span></dt><dt><span class="sect1"><a href="Topology.html#TopoGeom_Accessors">11.9. TopoGeometryアクセサ</a></span></dt><dt><span class="sect1"><a href="Topology.html#TopoGeometry_Outputs">11.10. TopoGeometry出力</a></span></dt></dl></div><p>PostGISトポロジ型と関数は、フェイス、エッジ、ノード等のトロポジオブジェクトを管理するために使います。</p><p>PostGIS Day Paris 2011におけるSandro Santilliさんの講演が、PostGISトポロジの概略説明として良いです。<a class="ulink" href="http://strk.keybit.net/projects/postgis/Paris2011_TopologyWithPostGIS_2_0.pdf" target="_top">Topology with PostGIS 2.0 slide deck</a> にあります。</p><p>Vincent Picavetさんはトポロジに関する説明とトポロジをサポートする各種FOSS4Gツールに関する、良い概略説明を<a class="ulink" href="http://2010.foss4g.org/presentations/3555.pdf" target="_top">State of the art of FOSS4G for topology and network analysis</a>で出しています。</p><p>トポロジベースのGISデータベースの例として<a class="ulink" href="http://www.census.gov/geo/www/tiger/overview.html" target="_top">US Census Topologically Integrated Geographic Encoding and Reference System (TIGER)</a>があります。PostGISトポロジの試験がしたくて、何らかのデータが必要なら<a class="xref" href="Topology_Load_Tiger.html" title="Topology_Load_Tiger">Topology_Load_Tiger</a>をご覧下さい</p><p>PostGISトポロジモジュールは前の版にもありましたが、正式なPostGIS文書の中には入れていませんでした。PostGIS 2.0.0 では、全ての非推奨関数が無くし、知られていた使いやすさの問題を解決し、機能と関数の文書をより良くし、新しい関数を追加し、SQL-MM標準により準拠させるために、大整理を行っています。</p><p>このプロジェクトの詳細情報は <a class="ulink" href="http://trac.osgeo.org/postgis/wiki/UsersWikiPostgisTopology" target="_top">PostGIS Topology Wiki</a> にあります。</p><p>このモジュールに関する全ての関数とテーブルは、<code class="varname">topology</code>スキーマにインストールされます。</p><p>SQL/MM標準で定義される関数はST_プリフィクスを持ち、PostGIS特有の関数はこのプリフィクスを持ちません。</p><p>トポロジ機能を持つPostGIS 2.0をビルドするには、<a class="xref" href="postgis_installation.html" title="第2章 インストール">2章<i>インストール</i></a>にもありますが--with-topologyオプションを付けてコンパイルします。GEOS 3.3以上に依存する関数があるため、完全にトポロジーをサポートするには GEOS 3.3以上でコンパイルします。</p><div class="sect1" title="11.1. トポロジ型"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Types"></a>11.1. トポロジ型</h2></div><div><div class="abstract" title="概要"><p class="title"><b>概要</b></p><p>本節では、PostGISトポロジでインストールされるPostgreSQLデータ型の一覧を挙げます。独自に関数をデザインする際に特に重要となる、キャストでの振る舞いを記述していることに、ご注意ください。
                </p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="getfaceedges_returntype.html">getfaceedges_returntype</a></span><span class="refpurpose"> — 順列番号とエッジ番号の複合型です。<code class="varname">ST_GetFaceEdges</code> が返す型です。</span></dt><dt><span class="refentrytitle"><a href="topogeometry.html">topogeometry</a></span><span class="refpurpose"> — 特定のトポロジ、レイヤ内の、識別番号の付いたトポロジジオメトリへの参照である複合型で、タイプ(1:[multi]point, 2:[multi]line, 3:[multi]poly, 4:collection)を持ちます。識別番号はトポロジ内のTopoGeometryについて一意に定義されます。</span></dt><dt><span class="refentrytitle"><a href="validatetopology_returntype.html">validatetopology_returntype</a></span><span class="refpurpose"> — 
エラーメッセージと、エラーの場所を示す、id1とid2からなる複合型です。これは<code class="varname">ValidateTopology</code>が返す型です。</span></dt></dl></div></div><div class="sect1" title="11.2. トポロジドメイン"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Domains"></a>11.2. トポロジドメイン</h2></div><div><div class="abstract" title="概要"><p class="title"><b>概要</b></p><p>本節では、PostGISトポロジでインストールされるPostgreSQLドメインのリストを挙げます。ドメインは、オブジェクト型のように扱え、関数やテーブルカラムのオブジェクトを返します。ドメインは存在するチェック制約のある型である点で、型とは違います。
                </p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="topoelement.html">TopoElement</a></span><span class="refpurpose"> — 2つの整数の配列で、通常TopoGeometry要素を識別するために使われます。</span></dt><dt><span class="refentrytitle"><a href="topoelementarray.html">topoelementarray</a></span><span class="refpurpose"> — element_id値とelement_type値の配列です。{{id,type}, {id,type}, ...}となる整数の2次元配列です。</span></dt></dl></div></div><div class="sect1" title="11.3. トポロジとTopoGeometryの管理"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_ManagementFunctions"></a>11.3. トポロジとTopoGeometryの管理</h2></div><div><div class="abstract" title="概要"><p class="title"><b>概要</b></p><p>本節では、新しいトポロジスキーマの構築、トポロジの評価、TopoGeometryカラムの管理のためのトポロジ関数の一覧を挙げます。</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="AddTopoGeometryColumn.html">AddTopoGeometryColumn</a></span><span class="refpurpose"> — 既存のテーブルにTopoGeometryカラムを追加し、topology.layer内に新しいレイヤとして新しいカラムを登録して、新しい layer_id を返します。</span></dt><dt><span class="refentrytitle"><a href="DropTopology.html">DropTopology</a></span><span class="refpurpose"> — 使用上の注意: この関数によって、トポロジスキーマが削除され、topology.topologyテーブルからの参照とgeometry_columnsテーブルからの削除対象スキーマ内のテーブルへの参照とが削除されます。</span></dt><dt><span class="refentrytitle"><a href="DropTopoGeometryColumn.html">DropTopoGeometryColumn</a></span><span class="refpurpose"> — <code class="varname">schema_name</code>で指定されたスキーマ内にある<code class="varname">table_name</code>で指定されたテーブルからTopoGeometryカラムを削除し、topology.layerテーブルにある登録を解除します。</span></dt><dt><span class="refentrytitle"><a href="TopologySummary.html">TopologySummary</a></span><span class="refpurpose"> — トポロジ名を取得し、トポロジ内のオブジェクトの型に関する概の全体を提供します。</span></dt><dt><span class="refentrytitle"><a href="ValidateTopology.html">ValidateTopology</a></span><span class="refpurpose"> — トポロジに関する問題を詳述するvalidatetopology_returntypeオブジェクトの集合を返します。</span></dt></dl></div></div><div class="sect1" title="11.4. トポロジコンストラクタ"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Constructors"></a>11.4. トポロジコンストラクタ</h2></div><div><div class="abstract" title="概要"><p class="title"><b>概要</b></p><p>本節では、新しいトポロジを生成するトポロジ関数を挙げます。</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="CreateTopology.html">CreateTopology</a></span><span class="refpurpose"> — 新しいトポロジスキーマを生成し、新しいスキーマをtopology.topologyテーブルに登録します。</span></dt><dt><span class="refentrytitle"><a href="CopyTopology.html">CopyTopology</a></span><span class="refpurpose"> — トポロジ構造(ノード、エッジ、フェイス、レイヤ、TopoGeometry)を複写します。</span></dt><dt><span class="refentrytitle"><a href="ST_InitTopoGeo.html">ST_InitTopoGeo</a></span><span class="refpurpose"> — 新しいトポロジスキーマを生成し、topology.topologyテーブルに新しいスキーマを登録し、処理の概要を表示します。</span></dt><dt><span class="refentrytitle"><a href="ST_CreateTopoGeo.html">ST_CreateTopoGeo</a></span><span class="refpurpose"> — 
空のトポロジにジオメトリのコレクションを追加し、成否を示すメッセージを返します。
				</span></dt><dt><span class="refentrytitle"><a href="TopoGeo_AddPoint.html">TopoGeo_AddPoint</a></span><span class="refpurpose"> — 
許容差を使って既存のトポロジにポイントを追加し、可能ならエッジを分割します。
				</span></dt><dt><span class="refentrytitle"><a href="TopoGeo_AddLineString.html">TopoGeo_AddLineString</a></span><span class="refpurpose"> — 
許容差を使って既存のトポロジにラインストリングを追加し、可能ならエッジ/フェイスを分割します。
				</span></dt><dt><span class="refentrytitle"><a href="TopoGeo_AddPolygon.html">TopoGeo_AddPolygon</a></span><span class="refpurpose"> — 
許容差を使って既存のトポロジにポリゴンを追加し、可能ならエッジ/フェイスを分割します。
				</span></dt></dl></div></div><div class="sect1" title="11.5. トポロジエディタ"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Editing"></a>11.5. トポロジエディタ</h2></div><div><div class="abstract" title="概要"><p class="title"><b>概要</b></p><p>本節では、エッジ、フェイス、ノードの追加、移動、削除、分割に関する関数を挙げます。本節の関数はすべてISO SQL/MMで定義されています。</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="ST_AddIsoNode.html">ST_AddIsoNode</a></span><span class="refpurpose"> — フェイスに孤立ノードを追加し、新しいノードの識別番号を返します。フェイスがNULLの場合でもノードは生成されます。</span></dt><dt><span class="refentrytitle"><a href="ST_AddIsoEdge.html">ST_AddIsoEdge</a></span><span class="refpurpose"> — <code class="varname">anode</code>と<code class="varname">anothernode</code>で指定される2つの既存孤立ノードを接続するトポロジに、ジオメトリ<code class="varname">aliestring</code>で定義される孤立エッジを追加し、新しいエッジの識別番号を返します。</span></dt><dt><span class="refentrytitle"><a href="ST_AddEdgeNewFaces.html">ST_AddEdgeNewFaces</a></span><span class="refpurpose"> — 新しいエッジを追加します。新しいエッジがフェイスを分割する場合には、もとのフェイスを削除して、分割した2つのフェイスに置き換えます。</span></dt><dt><span class="refentrytitle"><a href="ST_AddEdgeModFace.html">ST_AddEdgeModFace</a></span><span class="refpurpose"> — 新しいエッジを追加します。新しいエッジがフェイスを分割する場合には、もとのフェイスを編集し、1つのフェイスを追加します。</span></dt><dt><span class="refentrytitle"><a href="ST_RemEdgeNewFace.html">ST_RemEdgeNewFace</a></span><span class="refpurpose"> — 
エッジを削除し、消去対象エッジでフェイスが2つに分割されているなら、分割されているフェイスを削除し、1つのフェイスに置き換えます。
        </span></dt><dt><span class="refentrytitle"><a href="ST_RemEdgeModFace.html">ST_RemEdgeModFace</a></span><span class="refpurpose"> — 
エッジを削除し、削除対象エッジでフェイスが2つに分割されているなら、両方の空間をとるため、ひとつを削除して、もうひとつを編集します。
        </span></dt><dt><span class="refentrytitle"><a href="ST_ChangeEdgeGeom.html">ST_ChangeEdgeGeom</a></span><span class="refpurpose"> — 
Cトポロジ構造に影響を与えることなくエッジの形状を変更します。
				</span></dt><dt><span class="refentrytitle"><a href="ST_ModEdgeSplit.html">ST_ModEdgeSplit</a></span><span class="refpurpose"> — 既存のエッジに沿って新しいノードを生成してエッジを分割します。もとのエッジは変更され、エッジが1つ追加されます。</span></dt><dt><span class="refentrytitle"><a href="ST_ModEdgeHeal.html">ST_ModEdgeHeal</a></span><span class="refpurpose"> — 
2つのエッジについて、接続しているノードを削除して修復します。1番目のエッジを編集して、2番目のエッジを削除します。削除されたノードの識別番号を返します。
				</span></dt><dt><span class="refentrytitle"><a href="ST_NewEdgeHeal.html">ST_NewEdgeHeal</a></span><span class="refpurpose"> — 
2つのエッジについて、接続しているノードを削除して修復します。両方のエッジを削除し、1番目のエッジと同じ方向のエッジに置き換えます。
				</span></dt><dt><span class="refentrytitle"><a href="ST_MoveIsoNode.html">ST_MoveIsoNode</a></span><span class="refpurpose"> — トポロジ内の孤立ノードを別の位置に移動させます。新しい <code class="varname">apoint</code>ジオメトリがノードとして存在しているなら、エラーが投げられます。移動に関する記述を返します。</span></dt><dt><span class="refentrytitle"><a href="ST_NewEdgesSplit.html">ST_NewEdgesSplit</a></span><span class="refpurpose"> — 新しいノードを既存のエッジに沿って作成して、エッジを分割します。もとのエッジは削除され、2つのエッジに置き換えられます。2つの新しいエッジに接続する新しいノードの識別番号を返します。</span></dt><dt><span class="refentrytitle"><a href="ST_RemoveIsoNode.html">ST_RemoveIsoNode</a></span><span class="refpurpose"> — 孤立ノードを削除し、実行結果が返されます。ノードが孤立していない(エッジの始端または終端である)場合、例外が投げられます。</span></dt></dl></div></div><div class="sect1" title="11.6. トポロジアクセサ"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Accessors"></a>11.6. トポロジアクセサ</h2></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="GetEdgeByPoint.html">GetEdgeByPoint</a></span><span class="refpurpose"> — 与えられたポイントにインタセクトするエッジの識別番号を探索します。</span></dt><dt><span class="refentrytitle"><a href="GetFaceByPoint.html">GetFaceByPoint</a></span><span class="refpurpose"> — 与えられたポイントにインタセクトするフェイスの識別番号を探索します。</span></dt><dt><span class="refentrytitle"><a href="GetNodeByPoint.html">GetNodeByPoint</a></span><span class="refpurpose"> — ポイント位置にあるノードの識別番号を探索します。</span></dt><dt><span class="refentrytitle"><a href="GetTopologyID.html">GetTopologyID</a></span><span class="refpurpose"> — トポロジ名からtopology.topologyテーブル内にあるトポロジの識別番号を返します。</span></dt><dt><span class="refentrytitle"><a href="GetTopologySRID.html">GetTopologySRID</a></span><span class="refpurpose"> — トポロジ名からtopology.topologyテーブル内にあるトポロジのSRIDを返します。</span></dt><dt><span class="refentrytitle"><a href="GetTopologyName.html">GetTopologyName</a></span><span class="refpurpose"> — 識別番号からトポロジ(スキーマ)の名前を返します。</span></dt><dt><span class="refentrytitle"><a href="ST_GetFaceEdges.html">ST_GetFaceEdges</a></span><span class="refpurpose"> — 順序番号を含む、<code class="varname">aface</code>の境界となる、整列したエッジの集合を返します。</span></dt><dt><span class="refentrytitle"><a href="ST_GetFaceGeometry.html">ST_GetFaceGeometry</a></span><span class="refpurpose"> — 指定されたトポロジの中の、フェイス識別番号で指定されたポリゴンを返します。</span></dt><dt><span class="refentrytitle"><a href="GetRingEdges.html">GetRingEdges</a></span><span class="refpurpose"> — 
与えられたエッジで環を形成するエッジの集合を整列して返します。
				</span></dt><dt><span class="refentrytitle"><a href="GetNodeEdges.html">GetNodeEdges</a></span><span class="refpurpose"> — 
与えられたノードへのエッジのインシデンスの集合を整列して返します。
				</span></dt></dl></div></div><div class="sect1" title="11.7. トポロジ処理"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Topology_Processing"></a>11.7. トポロジ処理</h2></div><div><div class="abstract" title="概要"><p class="title"><b>概要</b></p><p>本節では、非標準の手法でのトポロジ処理の関数を挙げます。</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="TopologyPolygonize.html">Polygonize</a></span><span class="refpurpose"> — トポロジエッジで定義されるフェイスを探索し、追加します。</span></dt><dt><span class="refentrytitle"><a href="AddNode.html">AddNode</a></span><span class="refpurpose"> — 指定したトポロジスキーマのノードテーブルにポイントノードを追加し、新しいノードの識別番号を返します。指定したポイントに既にノードがある場合は既存のノード識別番号を返します。</span></dt><dt><span class="refentrytitle"><a href="AddEdge.html">AddEdge</a></span><span class="refpurpose"> — 指定したラインストリングジオメトリを使って指定したトポロジスキーマにおいて、ラインストリングエッジをエッジテーブルに追加し、関連する始点終点のノードをノードテーブルに追加し、新しい(または既存の)エッジの識別番号を返します。</span></dt><dt><span class="refentrytitle"><a href="AddFace.html">AddFace</a></span><span class="refpurpose"> — 
フェイスプリミティブをトポロジに登録し、その識別番号を得ます。
        </span></dt></dl></div></div><div class="sect1" title="11.8. TopoGeometryコンストラクタ"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="TopoGeometry_Constructors"></a>11.8. TopoGeometryコンストラクタ</h2></div><div><div class="abstract" title="概要"><p class="title"><b>概要</b></p><p>本節では、新しいTopoGeometryを生成するトポロジ関数を挙げます。</p></div></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="CreateTopoGeom.html">CreateTopoGeom</a></span><span class="refpurpose"> — 新しい TopoGeometryオブジェクトを topoエレメント配列から生成します - tg_type: 1:[multi]point, 2:[multi]line, 3:[multi]poly, 4:collection</span></dt><dt><span class="refentrytitle"><a href="toTopoGeom.html">toTopoGeom</a></span><span class="refpurpose"> — 単純なジオメトリからTopoGeometryを生成します。</span></dt><dt><span class="refentrytitle"><a href="TopoElementArray_Agg.html">TopoElementArray_Agg</a></span><span class="refpurpose"> — lement_idとタイプの配列(topoelements)からなる<code class="varname">topoelementarray</code>を返します。</span></dt></dl></div></div><div class="sect1" title="11.9. TopoGeometryアクセサ"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="TopoGeom_Accessors"></a>11.9. TopoGeometryアクセサ</h2></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="GetTopoGeomElementArray.html">GetTopoGeomElementArray</a></span><span class="refpurpose"> — トポロジ要素と与えられたTopoGeometryの型(プリミティブ要素)からなる<code class="varname">topoelementarray</code>(topoelementsの配列)を返します。</span></dt><dt><span class="refentrytitle"><a href="GetTopoGeomElements.html">GetTopoGeomElements</a></span><span class="refpurpose"> — 与えられたTopoGeometryオブジェクト(プリミティブ要素)のelement_id, element_typeを含む<code class="varname">topoelement</code>の集合を返します。</span></dt></dl></div></div><div class="sect1" title="11.10. TopoGeometry出力"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="TopoGeometry_Outputs"></a>11.10. TopoGeometry出力</h2></div></div></div><div class="toc"><dl><dt><span class="refentrytitle"><a href="AsGML.html">AsGML</a></span><span class="refpurpose"> — TopoGeometryのGML表現を返します。</span></dt></dl></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="RT_FAQ.html">戻る</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="getfaceedges_returntype.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第10章 PostGISラスタ よくある質問 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> getfaceedges_returntype</td></tr></table></div></body></html>
