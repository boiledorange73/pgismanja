<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>付録B 日本語訳に関する追加情報</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="PostGIS 2.0.0マニュアル日本語訳"><link rel="up" href="index.html" title="PostGIS 2.0.0マニュアル日本語訳"><link rel="prev" href="release_notes.html" title="付録A Appendix"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">付録B 日本語訳に関する追加情報</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="release_notes.html">戻る</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> </td></tr></table><hr></div><div class="appendix" title="付録B 日本語訳に関する追加情報"><div class="titlepage"><div><div><h2 class="title"><a name="japanese_appendix"></a>付録B 日本語訳に関する追加情報</h2></div></div></div><div class="toc"><p><b>目次</b></p><dl><dt><span class="sect1"><a href="japanese_appendix.html#intersects_and_crosses">B.1. 「インタセクト」と「クロス」</a></span></dt><dt><span class="sect1"><a href="japanese_appendix.html#srs_in_japan">B.2. 空間参照系等について</a></span></dt><dd><dl><dt><span class="sect2"><a href="japanese_appendix.html#wellused_srs_in_japan">B.2.1. わが国でよく使われる空間参照系</a></span></dt><dt><span class="sect2"><a href="japanese_appendix.html#geod_in_japan">B.2.2. 測地系</a></span></dt><dt><span class="sect2"><a href="japanese_appendix.html#utm_in_japan">B.2.3. UTM</a></span></dt><dt><span class="sect2"><a href="japanese_appendix.html#jpr">B.2.4. 平面直角座標系</a></span></dt></dl></dd><dt><span class="sect1"><a href="japanese_appendix.html#problem_tokyodatum">B.3. 日本測地系から投影変換する場合の問題点</a></span></dt><dd><dl><dt><span class="sect2"><a href="japanese_appendix.html#id287269452">B.3.1. Proj.4で問題点を見る</a></span></dt><dt><span class="sect2"><a href="japanese_appendix.html#id287269488">B.3.2. PostGISでの問題回避</a></span></dt></dl></dd><dt><span class="sect1"><a href="japanese_appendix.html#with_sjis">B.4. Shift JIS系文字コードについて</a></span></dt></dl></div><div class="sect1" title="B.1. 「インタセクト」と「クロス」"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="intersects_and_crosses"></a>B.1. 「インタセクト」と「クロス」</h2></div></div></div><p>intersectとcrossは、両方とも日本語では「交差」と言われます。違いを明確にするために、インタセクト(動詞)またはインタセクション(名詞)、クロス(動詞/名詞)と表現しています。</p><p>インタセクト(intersect)は「共有部分を持つ」もので、次元等は関係ありません。</p><p>クロス(cross)は、「共通部分を持ち、共通部分の次元は引数ジオメトリの最大次元より低い」ものです。なお、ここで言う次元は、面、線、点の区別です。</p><p>たとえば、面/面のクロスは線または点です。共通部分が面の場合は、クロスしているとは言いません。</p><p>また、線/線のクロスは必ず点です。共通部分が線の場合は、クロスしているとは言いません。</p></div><div class="sect1" title="B.2. 空間参照系等について"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="srs_in_japan"></a>B.2. 空間参照系等について</h2></div></div></div><div class="toc"><dl><dt><span class="sect2"><a href="japanese_appendix.html#wellused_srs_in_japan">B.2.1. わが国でよく使われる空間参照系</a></span></dt><dt><span class="sect2"><a href="japanese_appendix.html#geod_in_japan">B.2.2. 測地系</a></span></dt><dt><span class="sect2"><a href="japanese_appendix.html#utm_in_japan">B.2.3. UTM</a></span></dt><dt><span class="sect2"><a href="japanese_appendix.html#jpr">B.2.4. 平面直角座標系</a></span></dt></dl></div><p>しばしば「マサチューセッツ州」の空間参照系が出てきますが、わが国では使われません。わが国でよく使われる空間参照系および若干の説明を以下に記載します。</p><div class="sect2" title="B.2.1. わが国でよく使われる空間参照系"><div class="titlepage"><div><div><h3 class="title"><a name="wellused_srs_in_japan"></a>B.2.1. わが国でよく使われる空間参照系</h3></div></div></div><p>わが国では、次の空間参照系がよく使われます。</p><p>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>EPSGコード</th><th>名称等</th></tr></thead><tbody><tr><td>4326</td><td>WGS84 経度緯度</td></tr><tr><td>4612</td><td>世界測地系 経度緯度</td></tr><tr><td>2443-2461</td><td>世界測地系 平面直角座標系(I系-XIX系)</td></tr><tr><td>3097-3101</td><td>世界測地系 UTM(ゾーン51-55)</td></tr><tr><td>4301</td><td>日本測地系 経度緯度</td></tr><tr><td>30161-30179</td><td>日本測地系 平面直角座標系(I系-XIX系)</td></tr><tr><td>3092-3096</td><td>日本測地系 UTM(ゾーン51-55)</td></tr></tbody></table></div><p>
          </p></div><div class="sect2" title="B.2.2. 測地系"><div class="titlepage"><div><div><h3 class="title"><a name="geod_in_japan"></a>B.2.2. 測地系</h3></div></div></div><p>日本測地系は2002年3月31日まで使用されていたものです。世界測地系は現在使用されているものです。WGS84は米軍がGPS用に管理している測地系です。</p><p>世界測地系とWGS84とはあまり差がなく、メートル単位の誤差を許容する場合には、そのまま使用しても差し支えない程度です。</p><p>世界測地系と日本測地系は、投影変換を要します。</p></div><div class="sect2" title="B.2.3. UTM"><div class="titlepage"><div><div><h3 class="title"><a name="utm_in_japan"></a>B.2.3. UTM</h3></div></div></div><p>UTMは、1万分の1 から 20万分の1 の地形図に用いられます。ゾーンは地球全体を経度6度ごとにゾーンを定めています。よってゾーン番号は経度で決まります。ゾーン番号と経度範囲の関係は次の通りです。</p><p>
            </p><div class="informaltable"><table border="1"><colgroup><col><col></colgroup><thead><tr><th>ゾーン番号</th><th>経度範囲</th></tr></thead><tbody><tr><td>51</td><td>東経120度 から 東経126度</td></tr><tr><td>52</td><td>東経126度 から 東経132度</td></tr><tr><td>53</td><td>東経132度 から 東経138度</td></tr><tr><td>54</td><td>東経138度 から 東経144度</td></tr><tr><td>55</td><td>東経144度 から 東経150度</td></tr></tbody></table></div><p>
          </p><p>ゾーンをまたぐ場合は、通常は、より広くインタセクトしている方のゾーンを用います。</p></div><div class="sect2" title="B.2.4. 平面直角座標系"><div class="titlepage"><div><div><h3 class="title"><a name="jpr"></a>B.2.4. 平面直角座標系</h3></div></div></div><p>平面直角座標系は、1万分の1 よりも大縮尺(詳細)の地図に用いられます。国内陸域を19個の系に分けています。概ね1つの系に対して複数の都府県が対応し、都府県が複数の系に分かれることは少ないですが、離島部を持つ都県は複数の系をまたぎますし、北海道は3つの系に分かれています。</p><p>詳細については<a class="ulink" href="http://www.gsi.go.jp/LAW/heimencho.html" target="_top">平面直角座標系(平成14年国土交通省告示第9号)</a>(国土地理院サイト)をご覧ください。</p><p>また、<a class="ulink" href="http://www.finds.jp/pinfo/index.html" target="_top">地図関連情報ガジェット</a>(Finds.jp)にて、系番号を簡易的に確認できます。</p></div></div><div class="sect1" title="B.3. 日本測地系から投影変換する場合の問題点"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="problem_tokyodatum"></a>B.3. 日本測地系から投影変換する場合の問題点</h2></div></div></div><div class="toc"><dl><dt><span class="sect2"><a href="japanese_appendix.html#id287269452">B.3.1. Proj.4で問題点を見る</a></span></dt><dt><span class="sect2"><a href="japanese_appendix.html#id287269488">B.3.2. PostGISでの問題回避</a></span></dt></dl></div><p>日本測地系と他の測地系を一緒に扱う必要がある場合には、日本測地系に関連する投影変換パラメータに問題があるので、注意が必要です。</p><p>日本測地系からWGS84や世界測地系等に変換するに際には、準拠回転楕円体情報のほか、中心位置のシフトや回転等のパラメータを渡す必要があります。Proj.4のパラメータファイルには、シフトや回転等については指定されていません。 PostGISを含む、Proj.4をもとにして作成されているソフトウェアは、基本的にこの問題の影響を受けます。また、PostGISの<code class="varname">spatial_ref_sys</code>テーブルは、Proj.4の設定ファイルを基にしています。 </p><div class="sect2" title="B.3.1. Proj.4で問題点を見る"><div class="titlepage"><div><div><h3 class="title"><a name="id287269452"></a>B.3.1. Proj.4で問題点を見る</h3></div></div></div><p>ご注意: PostGISで投影変換を行う場合には、空間データベースにある<code class="varname">spatial_ref_sys</code>を更新しなければなりません。 </p><pre class="programlisting"># Tokyo
&lt;4301&gt; +proj=longlat +ellps=bessel +no_defs &lt;&gt;</pre><p>なお、+no_defsは、デフォルトファイルを読み込まないことを指示しています。このエントリの記述通りに動作することを保障するために必要です。
          </p><p>&lt;&gt;(終端文字列)より前に、たとえば、+towgs84=-146.336,506.832,680.254,0,0,0,0を挿入します。 次のようになります。</p><div class="note" title="注記" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[注記]" src="images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>(2013年5月24日 追記) 2.xでは -148,507,685,0,0,0,0 が既に入れられています。</p><p>パラメータには、いくつかのバリエーションがあります。</p></td></tr></table></div><pre class="programlisting"># Tokyo
&lt;4301&gt; +proj=longlat +ellps=bessel +towgs84=-146.336,506.832,680.254,0,0,0,0 +no_defs &lt;&gt;</pre><p>4301のほか、30161-30179, 3092-3096についても同じように改訂することで、数メートル程度の誤差に収まるようになります。ただし、なお誤差を含みますので、十分にご注意ください。</p></div><div class="sect2" title="B.3.2. PostGISでの問題回避"><div class="titlepage"><div><div><h3 class="title"><a name="id287269488"></a>B.3.2. PostGISでの問題回避</h3></div></div></div><p><code class="varname">spatial_ref_sys</code>の中身を見てみましょう。</p><pre class="programlisting">select ST_AsEWKT(ST_Transform('SRID=4612;POINT(135 35)'::geometry,4301));
        st_asewkt        
-------------------------
 SRID=4301;POINT(135 35)
(1 row)</pre><p>proj4textを更新すると、変換結果が変わります。</p><pre class="programlisting">db=# UPDATE spatial_ref_sys SET proj4text='+proj=longlat +ellps=bessel +towgs84=-146.336,506.832,680.254,0,0,0,0 +no_defs' WHERE srid=4301;
UPDATE 1

db=# select ST_AsEWKT(ST_Transform('SRID=4612;POINT(135 35)'::geometry,4301));
                     st_asewkt                      
----------------------------------------------------
 SRID=4301;POINT(135.002792603664 34.9968021008188)
(1 row)</pre></div></div><div class="sect1" title="B.4. Shift JIS系文字コードについて"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="with_sjis"></a>B.4. Shift JIS系文字コードについて</h2></div></div></div><p>コンフィギュレーション時にlibiconvを使用するようにした場合には，shp2pgsqlコマンドで-Wオプションを使用できるようになります．このオプションよって，SQLデータに変換する際に，文字コード変換を併せて行うことができます(<a class="xref" href="using_postgis_dbmanagement.html#shp2pgsql_usage" title="4.4.2. ローダを使う">「ローダを使う」</a>を参照して下さい)．</p><p>国内の地理空間データでは，伝統的にShift JIS系の文字セットがよく使われています．ただし，Shift JISそのものでは，地名に使用される文字で対応し切れず，適正なSQLが出力されないことがあります．</p><p>実際には，Shift JISをもとにして独自文字を持つ"cp932"が主に使われています．cp932とShift JISとは，iconvでは異なるものとされています．iconvコマンドがインストールされているなら，次のように文字コード一覧を表示させてみて下さい．</p><pre class="programlisting">% iconv --list
...
MS_KANJI SHIFT-JIS SHIFT_JIS SJIS CSSHIFTJIS
CP932
...</pre><p>shp2pgsqlは，たとえば次のように使用します．</p><pre class="programlisting">% shp2pgsql -W cp932 -D -i -I foo.shp tablename &gt; foo.sql</pre></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="release_notes.html">戻る</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> </td></tr><tr><td width="40%" align="left" valign="top">付録A Appendix </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> </td></tr></table></div></body></html>
