<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>第6章 PostGISリファレンス</title><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.76.1"><link rel="home" href="index.html" title="PostGISマニュアル"><link rel="up" href="index.html" title="PostGISマニュアル"><link rel="prev" href="ch05.html" title="第5章 性能向上に関する技法"><link rel="next" href="apa.html" title="付録A リリースノート"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">第6章 PostGISリファレンス</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch05.html">戻る</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="apa.html">次へ</a></td></tr></table><hr></div><div class="chapter" title="第6章 PostGISリファレンス"><div class="titlepage"><div><div><h2 class="title"><a name="idp63792328"></a>第6章 PostGISリファレンス</h2></div></div></div><div class="toc"><p><b>目次</b></p><dl><dt><span class="sect1"><a href="ch06.html#idp63793352">6.1. OpenGIS関数</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch06.html#idp63793992">6.1.1. 管理関数</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp63799880">6.1.2. 空間関係関数</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp63835336">6.1.3. ジオメトリ処理関数</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp63871560">6.1.4. ジオメトリアクセサ</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp63932744">6.1.5. ジオメトリ コンストラクタ</a></span></dt></dl></dd><dt><span class="sect1"><a href="ch06.html#idp63982024">6.2. PostGIS独自拡張</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch06.html#idp63982664">6.2.1. 管理関数</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp64004168">6.2.2. 演算子</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp64023752">6.2.3. 計測関数</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp64047688">6.2.4. ジオメトリ出力</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp64077128">6.2.5. ジオメトリ コンストラクタ</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp64104520">6.2.6. ジオメトリエディタ</a></span></dt><dt><span class="sect2"><a href="ch06.html#idp64132168">6.2.7. その他の関数</a></span></dt></dl></dd></dl></div><p>ここで示す関数はPostGISユーザが必要とすると思われる関数です。この他に、一般的なユーザが使わないPostGISオブジェクトに対して求められるサポート関数があります。</p><div class="sect1" title="6.1. OpenGIS関数"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp63793352"></a>6.1. OpenGIS関数</h2></div></div></div><div class="sect2" title="6.1.1. 管理関数"><div class="titlepage"><div><div><h3 class="title"><a name="idp63793992"></a>6.1.1. 管理関数</h3></div></div></div><div class="variablelist"><dl><dt><a name="AddGeometryColumn"></a><span class="term">AddGeometryColumn(varchar, varchar, varchar, integer, varchar, integer)</span></dt><dd><p>構文: AddGeometryColumn(&lt;スキーマ名&gt;, &lt;テーブル名&gt;, &lt;カラム名&gt;, &lt;srid&gt;, &lt;タイプ&gt;, &lt;次元&gt;). 存在する属性テーブル (訳注:ジオメトリカラムが存在しない意と思われますが、ジオメトリカラムが既に存在していても追加できます)」にジオメトリカラムを追加します。スキーマ名は、テーブルスキーマの名前です (プリスキーマ版PostgreSQLの場合は使われません)。 sridは、SPATIAL_REF_SYSテーブルに登録されている整数値でなければなりません。 型は、'POLGYON', 'MULTILINESTRING' などのように、常に大文字の文字列で、ジオメトリ型に対応していなければなりません。</p></dd><dt><span class="term">DropGeometryColumn(varchar, varchar, varchar)</span></dt><dd><p>構文: DropGeometryColumn(&lt;スキーマ名&gt;, &lt;テーブル名&gt;, &lt;カラム名&gt;). ジオメトリカラムを空間テーブルから削除します。 スキーマ名はgeometry_columnsテーブル内にある、そのテーブル名を持つ行のf_schema_nameフィールドと一致しなければならないことに注意して下さい。</p></dd><dt><span class="term">SetSRID(geometry)</span></dt><dd><p>ジオメトリのSRIDを特定の整数値に設定します。クエリのためのバウンディングボックスを生成する際に使います。</p></dd></dl></div></div><div class="sect2" title="6.1.2. 空間関係関数"><div class="titlepage"><div><div><h3 class="title"><a name="idp63799880"></a>6.1.2. 空間関係関数</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">Distance(geometry,geometry)</span></dt><dd><p>二つのジオメトリ間の2次元距離の最大値を、投影法の単位で返します。</p></dd><dt><span class="term">Equals(geometry,geometry)</span></dt><dd><p>ジオメトリが「空間的に等価」であるなら1 (TRUE)を返します。 '='より「良い」回答が得られます。equals('LINESTRING(0 0, 10 10)','LINESTRING(0 0, 5 5, 10 10)')は、TRUEになります。</p><p>GEOSモジュールによって実現しています。</p><p>OGC SPEC s2.1.1.2</p></dd><dt><span class="term">Disjoint(geometry,geometry)</span></dt><dd><p>ジオメトリが「空間的に接続されていない」なら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: これは論理値を返して整数を返さないのが「許される」版です。</p><p>OGC SPEC s2.1.1.2 //s2.1.13.3 - a.Relate(b, 'FF*FF****')</p></dd><dt><span class="term">Intersects(geometry,geometry)</span></dt><dd><p>ジオメトリが「空間的にインタセクトしている (訳注:共通領域を持つ)」なら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: これは論理値を返して整数を返さないのが「許される」版です。</p><p>OGC SPEC s2.1.1.2 //s2.1.13.3 - Intersects(g1, g2 ) --&gt; Not (Disjoint(g1, g2 ))</p></dd><dt><span class="term">Touches(geometry,geometry)</span></dt><dd><p>ジオメトリが「空間的に接触している」なら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: これは論理値を返して整数を返さないのが「許される」版です。</p><p>OGC SPEC s2.1.1.2 // s2.1.13.3- a.Touches(b) -&gt; (I(a) intersection I(b) = {empty set} ) and (a intersection b) not empty</p></dd><dt><span class="term">Crosses(geometry,geometry)</span></dt><dd><p>ジオメトリが「空間的にクロスしている (訳注:共通領域を持ち、かつ共通領域の次元が引数ジオメトリの最大次元-1」なら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: これは論理値を返して整数を返さないのが「許される」版です。</p><p>OGC SPEC s2.1.1.2 // s2.1.13.3 - a.Relate(b, 'T*T******')</p></dd><dt><span class="term">Within(geometry,geometry)</span></dt><dd><p>ジオメトリAが「空間的に」ジオメトリB「の中にある」なら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: これは論理値を返して整数を返さないのが「許される」版です。</p><p>OGC SPEC s2.1.1.2 // s2.1.13.3 - a.Relate(b, 'T*F**F***')</p></dd><dt><span class="term">Overlaps(geometry,geometry)</span></dt><dd><p>ジオメトリが「空間的にオーバラップしている (訳注:共通領域を持ち、引数の2ジオメトリと共通領域が同次元で、かつ共通領域が引数の2ジオメトリと同一でない)」なら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: これは論理値を返して整数を返さないのが「許される」版です。</p><p>OGC SPEC s2.1.1.2 // s2.1.13.3</p></dd><dt><span class="term">Contains(geometry,geometry)</span></dt><dd><p>ジオメトリAがジオメトリBを「空間的に含んでいる」なら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: これは論理値を返して整数を返さないのが「許される」版です。</p><p>OGC SPEC s2.1.1.2 // s2.1.13.3 - same as within(geometry,geometry)</p></dd><dt><span class="term">Intersects(geometry,geometry)</span></dt><dd><p>ジオメトリが「空間的にインタセクトしている (訳注:共通領域を持つ)」なら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: これは論理値を返して整数を返さないのが「許される」版です。</p><p>OGC SPEC s2.1.1.2 // s2.1.13.3 - NOT disjoint(geometry,geometry)</p></dd><dt><span class="term">Relate(geometry,geometry, intersectionPatternMatrix)</span></dt><dd><p>このジオメトリが空間的に、もう一つのジオメトリに関連しているなら1 (TRUE)を返します。 この関連は、intersectionPatternMatrix行列の値によって指定された、 二つのジオメトリの内部、境界、外部の交差要素を見ることで決定されます。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: これは論理値を返して整数を返さないのが「許される」版です。</p><p>OGC SPEC s2.1.1.2 // s2.1.13.3</p></dd><dt><span class="term">Relate(geometry,geometry)</span></dt><dd><p>DE-9IM (次元拡張された9要素行列)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>OGC仕様にはありませんが実装しました。s2.1.13.2をご覧下さい。</p></dd></dl></div></div><div class="sect2" title="6.1.3. ジオメトリ処理関数"><div class="titlepage"><div><div><h3 class="title"><a name="idp63835336"></a>6.1.3. ジオメトリ処理関数</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">Centroid(geometry)</span></dt><dd><p>ジオメトリの重心をポイントとして返します。</p><p>GEOSモジュールによって実現されている (コンパイル時に指定されます)なら、より正確に計算できます。</p></dd><dt><span class="term">Area(geometry)</span></dt><dd><p>ジオメトリがポリゴンかマルチポリゴンならジオメトリの面積を返します。 </p></dd><dt><span class="term">Length(geometry)</span></dt><dd><p>ジオメトリの、組み込まれている空間参照系での曲線長を返します。</p><p>これはlength2d()の別名です。</p><p>OGC SPEC 2.1.5.1</p></dd><dt><span class="term">PointOnSurface(geometry)</span></dt><dd><p>表面にあることが保障された点を返します。</p><p>GEOSモジュールによって実現しています。</p><p>OGC SPEC 3.2.14.2 and 3.2.18.2 -</p></dd><dt><span class="term">Boundary(geometry)</span></dt><dd><p>ジオメトリの組み合わせ境界の閉包を返します (訳注: ラインストリングは端点、ポリゴンはエッジ、複合オブジェクトは境界のうち奇数番)。組み合わせ境界はOGC仕様の3.12.3.2節に記述されています。結果として出てくる境界は、OGC SPEC 3.12.2で議論されているように、ジオメトリプリミティブを使って表現できます。</p><p>GEOSモジュールによって実現しています。</p><p>OGC SPEC s2.1.1.1</p></dd><dt><span class="term">Buffer(geometry,double,[integer])</span></dt><dd><p>ジオメトリからの距離が指定した距離未満となる全てのポイントを示すジオメトリを返します。オプションの第3引数では、4分の1にした円を近似するために使われる弦の数を設定します (デフォルトは8です)。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>OGC SPEC s2.1.1.3</p></dd><dt><span class="term">ConvexHull(geometry)</span></dt><dd><p>ジオメトリの凸包を表現するジオメトリを返します。</p><p>GEOSモジュールによって実現しています。</p><p>OGC SPEC s2.1.1.3</p></dd><dt><span class="term">Intersection(geometry,geometry)</span></dt><dd><p>ジオメトリがインタセクトする点を示すジオメトリを返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>OGC SPEC s2.1.1.3</p></dd><dt><span class="term">SymDifference(geometry,geometry)</span></dt><dd><p>ジオメトリの対称差 (AとBで共通しない部分)を示すジオメトリを返します。対称と呼ばれるのは、ST_SymDifference(A,B) = ST_SymDifference(B,A)となるからです。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>OGC SPEC s2.1.1.3</p></dd><dt><span class="term">Difference(geometry,geometry)</span></dt><dd><p>ジオメトリの対称差 (AとBで共通しない部分)を示すジオメトリを返します。対称と呼ばれるのは、ST_SymDifference(A,B) = ST_SymDifference(B,A)となるからです。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>OGC SPEC s2.1.1.3</p></dd><dt><span class="term">GeomUnion(geometry,geometry)</span></dt><dd><p>ジオメトリを結合したポイント集合を示すジオメトリを返します。</p><p>GEOSモジュールによって実現しています。</p><p>ジオメトリコレクションを引数として呼ばないでください。</p><p>ご注意: この関数は"union"から名前を変更しました。SQLの予約語であるためです。</p><p>OGC SPEC s2.1.1.3</p></dd><dt><span class="term">GeomUnion(geometry set)</span></dt><dd><p>与えられた集合の全てのジオメトリを結合したポイント集合を示すジオメトリを返します。</p><p>GEOSモジュールによって実現しています。</p><p>GeometryCollectionを引数集合で呼んではいけません。</p><p>OGC仕様では明示的に定義されていません。</p></dd><dt><span class="term">MemGeomUnion(geometry set)</span></dt><dd><p>上と同じですが、メモリフレンドリ (少ないメモリ使用で長い処理時間)です。</p></dd></dl></div></div><div class="sect2" title="6.1.4. ジオメトリアクセサ"><div class="titlepage"><div><div><h3 class="title"><a name="idp63871560"></a>6.1.4. ジオメトリアクセサ</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">AsText(geometry)</span></dt><dd><p>ジオメトリのWell-Known Text表現を返します。たとえばPOLYGON(0 0,0 1,1 1,1 0,0 0)などです。</p><p>OGC SPEC s2.1.1.1</p></dd><dt><span class="term">AsBinary(geometry)</span></dt><dd><p>ジオメトリをOGC"Well-Known Binary"表現で返します。データベースが動いているサーバのエンディアンを使います。これは文字列表現に変換せずにデータをデータベースから引き出すバイナリカーソルに有用です。</p><p>OGC SPEC s2.1.1.1 - asBinary(&lt;geometry&gt;,'XDR') and asBinary(&lt;geometry&gt;,'NDR')も参照して下さい</p></dd><dt><span class="term">SRID(geometry)</span></dt><dd><p>ジオメトリの空間参照系SRIDを整数で返します。</p><p>OGC SPEC s2.1.1.1</p></dd><dt><span class="term">Dimension(geometry)</span></dt><dd><p>このジオメトリオブジェクトの固有の次元です。 ジオメトリオブジェクトは座標の次元以下である必要があります。OGC SPEC s2.1.1.1 - 0ならポイント、1ならライン、2ならポリゴン、ジオメトリコレクションの場合は要素ごとの次元の最大値です。</p><pre class="programlisting">select dimension('GEOMETRYCOLLECTION(LINESTRING(1 1,0 0),POINT(0 0)'); 
dimension 
-----------
1</pre></dd><dt><span class="term">Envelope(geometry)</span></dt><dd><p>ジオメトリーのバウンディングボックスを表している有効なジオメトリ (POINT、LINESTRINGまたはPOLYGON)を返します。</p><p>OGC SPEC s2.1.1.1 -このジオメトリの最小のバウンディングボックスをジオメトリとして返します。ポリゴンはバウンディングボックスの頂点((MINX, MINY), (MAXX, MINY), (MAXX, MAXY), (MINX, MAXY), (MINX, MINY))で定義されます。</p><p>ご注意: PostGISはZmin/Zmax座標も同様に加えます。</p></dd><dt><span class="term">IsEmpty(geometry)</span></dt><dd><p>ジオメトリが空ジオメトリなら1 (TRUE)を返します。 TRUEなら、このジオメトリは空のポイント集合を示すジオメトリ、すなわちGEOMETRYCOLLECTION(EMPTY)です。</p><p>OGC SPEC s2.1.1.1</p></dd><dt><a name="IsSimple"></a><span class="term">IsSimple(geometry)</span></dt><dd><p>ジオメトリが、自己交差、自己接触といった異常な幾何学点を持っていないなら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>OGC SPEC s2.1.1.1</p></dd><dt><a name="IsClosed"></a><span class="term">IsClosed(geometry)</span></dt><dd><p>開始点と終了点とが同じになっているジオメトリならTRUEを返します。</p></dd><dt><span class="term">IsRing(geometry)</span></dt><dd><p>この曲線が閉じていて( StartPoint( ) = EndPoint( ) )、この曲線が単純 (2回以上同一点を通過しない)なら1 (TRUE)を返します。</p><p>GEOSモジュールによって実現しています。</p><p>OGC spec 2.1.5.1</p></dd><dt><span class="term">NumGeometries(geometry)</span></dt><dd><p>ジオメトリがGEOMETRYCOLLECTION (または MULTI系)の場合はジオメトリ数を返し、そうでないならNULLを返します。</p></dd><dt><span class="term">GeometryN(geometry,int)</span></dt><dd><p>ジオメトリがGEOMETRYCOLLECTION, MULTIPOINT, MULTILINESTRINGまたはMULTIPOLYGONの場合はN番目のジオメトリを返します。それ以外の場合はNULLを返します。</p><p>1が最初のジオメトリです。</p></dd><dt><span class="term">NumPoints(geometry)</span></dt><dd><p>ジオメトリの最初のラインストリングのポイント数を返します。ジオメトリにラインストリングが無い場合はNULLを返します。</p></dd><dt><span class="term">PointN(geometry,integer)</span></dt><dd><p>ジオメトリの最初のラインストリングにおける、N番目のポイントを返します。ジオメトリにラインストリングが無い場合はNULLを返します。</p></dd><dt><span class="term">ExteriorRing(geometry)</span></dt><dd><p>ポリゴンの外環を返します。ジオメトリがポリゴンでない場合はNULLを返します。</p></dd><dt><span class="term">NumInteriorRings(geometry)</span></dt><dd><p>ジオメトリの最初のポリゴンの内環数を返します。ジオメトリにポリゴンが無い場合はNULLを返します。</p></dd><dt><span class="term">InteriorRingN(geometry,integer)</span></dt><dd><p>ポリゴンのN番目の内環を返します。ジオメトリがポリゴンでないか、N番が範囲外である場合はNULLを返します。</p></dd><dt><span class="term">EndPoint(geometry)</span></dt><dd><p>ラインストリングの最後のポイントをポイントで返します。</p></dd><dt><span class="term">StartPoint(geometry)</span></dt><dd><p>ラインストリングの最初のポイントをポイントで返します。</p></dd><dt><a name="GeometryType"></a><span class="term">GeometryType(geometry)</span></dt><dd><p>ジオメトリタイプを文字列で返します。たとえば'LINESTRING', 'POLYGON', 'MULTIPOINT'等です。</p><p>OGC SPEC s2.1.1.1 - このジオメトリインスタンスがメンバーになっているジオメトリのインスタンス化可能な派生タイプの名前を返します。インスタンス化可能な派生タイプの名前は、文字列として返されます。</p></dd><dt><span class="term">X(geometry)</span></dt><dd><p>ジオメトリの最初のポイントのX値を探索して返します。ジオメトリにポイントが無い場合はNULLを返します。</p></dd><dt><span class="term">Y(geometry)</span></dt><dd><p>ジオメトリの最初のポイントのY値を探索して返します。ジオメトリにポイントが無い場合はNULLを返します。</p></dd><dt><span class="term">Z(geometry)</span></dt><dd><p>ジオメトリの最初のポイントのZ値を探索して返します。ジオメトリにポイントが無い場合はNULLを返します。</p></dd></dl></div></div><div class="sect2" title="6.1.5. ジオメトリ コンストラクタ"><div class="titlepage"><div><div><h3 class="title"><a name="idp63932744"></a>6.1.5. ジオメトリ コンストラクタ</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">GeomFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p></dd><dt><span class="term">PointFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKTがポイントでない場合はエラーを投げます。</p></dd><dt><span class="term">LineFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p></dd><dt><span class="term">LinestringFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>仕様適合のためです。</p><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p></dd><dt><span class="term">PolyFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKTがポリゴンでない場合はエラーを投げます。</p></dd><dt><span class="term">PolygonFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>仕様適合のためです。</p><p>WKTがポリゴンでない場合はエラーを投げます。</p></dd><dt><span class="term">MPointFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKTがマルチポイントでない場合はエラーを投げます。</p></dd><dt><span class="term">MLineFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKTがマルチラインストリングでない場合はエラーを投げます。</p></dd><dt><span class="term">MPolyFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKTがマルチポリゴンでない場合はエラーを投げます。</p></dd><dt><span class="term">GeomCollFromText(text,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKTから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKTがジオメトリコレクションでない場合はエラーを投げます。</p></dd><dt><span class="term">GeomFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p></dd><dt><span class="term">GeomFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p></dd><dt><span class="term">PointFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKBがポイントでない場合はエラーを投げます。</p></dd><dt><span class="term">LineFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKBがラインストリングでない場合はエラーを投げます。</p></dd><dt><span class="term">LinestringFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>仕様適合のためです。</p><p>WKBがラインストリングでない場合はエラーを投げます。</p></dd><dt><span class="term">PolyFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKBがポリゴンでない場合はエラーを投げます。</p></dd><dt><span class="term">PolygonFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>仕様適合のためです。</p><p>WKBがポリゴンでない場合はエラーを投げます。</p></dd><dt><span class="term">MPointFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKBがマルチポイントでない場合はエラーを投げます。</p></dd><dt><span class="term">MLineFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKBがマルチラインストリングでない場合はエラーを投げます。</p></dd><dt><span class="term">MPolyFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKBがマルチポリゴンでない場合はエラーを投げます。</p></dd><dt><span class="term">GeomCollFromWKB(bytea,[&lt;srid&gt;])</span></dt><dd><p>ジオメトリをWKBから作成し、SRIDを与えます。SRIDが与えられない場合は-1をデフォルトで与えます。</p><p>OGC SPEC 3.2.6.2 - 任意引数SRIDは仕様適合のためです。</p><p>WKBがジオメトリコレクションでない場合はエラーを投げます。</p></dd></dl></div></div></div><div class="sect1" title="6.2. PostGIS独自拡張"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="idp63982024"></a>6.2. PostGIS独自拡張</h2></div></div></div><div class="sect2" title="6.2.1. 管理関数"><div class="titlepage"><div><div><h3 class="title"><a name="idp63982664"></a>6.2.1. 管理関数</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">DropGeometryTable([&lt;スキーマ名&gt;], &lt;テーブル名&gt;)</span></dt><dd><p>テーブルとgeometry_columnsからの参照を削除します。 ご注意: スキーマ対応版PostgreSQLでは、スキーマが与えられない場合はcurrent_schema()を使います。</p></dd><dt><span class="term">UpdateGeometrySRID([&lt;schema_name&gt;], &lt;table_name&gt;, &lt;column_name&gt;, &lt;srid&gt;)</span></dt><dd><p>ジオメトリカラムにある全てのフィーチャーのSRIDを更新し、SRIDに関するジオメトリ制限とgeometry_columnsのSRIDを更新します。ご注意: スキーマ対応版PostgreSQLでは、スキーマが与えられない場合はcurrent_schema()を使います。</p></dd><dt><span class="term">update_geometry_stats([&lt;table_name&gt;, &lt;column_name&gt;])</span></dt><dd><p>クエリプランナが使う、空間テーブルの統計情報を更新します。統計情報収集処理を完全にするためにはには"VACUUM ANALYZE [テーブル名] [カラム名]"も実行する必要があります。ご注意: PostgreSQL 8.0からは統計情報の収集は"VACUUM ANALYZE"で自動的に行われます。</p></dd><dt><span class="term">postgis_version()</span></dt><dd><p>このデータベースにインストールされたPostGIS関数の版番号を返します (非推奨です。替わりにpostgis_full_version()を使います)。</p></dd><dt><span class="term">postgis_lib_version()</span></dt><dd><p>PostGISライブラリの版を返します。</p></dd><dt><span class="term">postgis_lib_build_date()</span></dt><dd><p>PostGISライブラリをビルドした日を返します。</p></dd><dt><span class="term">postgis_script_build_date()</span></dt><dd><p>PostGISスクリプトをビルドした日を返します。</p></dd><dt><span class="term">postgis_scripts_installed()</span></dt><dd><p>インストールされたlwpostgis.sqlスクリプトの版番号を返します。</p></dd><dt><span class="term">postgis_scripts_released()</span></dt><dd><p>インストールされたPostGISライブラリからリリースされたlwpostgis.sqlスクリプトの版番号を返します。</p></dd><dt><span class="term">postgis_geos_version()</span></dt><dd><p>GEOSライブラリの版を返します。GEOS対応が有効でないならNULLを返します。</p></dd><dt><span class="term">postgis_proj_version()</span></dt><dd><p>PROJ4ライブラリの版を返します。PROJ4対応が有効でないならNULLを返します。</p></dd><dt><span class="term">postgis_uses_stats()</span></dt><dd><p>STATSの使用が可能になっているならTRUEを返し、そうでないならFALSEを返します。</p></dd><dt><span class="term">postgis_full_version()</span></dt><dd><p>完全なPostGISの版情報とコンフィギュレーション情報を報告します。</p></dd></dl></div></div><div class="sect2" title="6.2.2. 演算子"><div class="titlepage"><div><div><h3 class="title"><a name="idp64004168"></a>6.2.2. 演算子</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">A &amp;&lt; B</span></dt><dd><p>"&amp;&lt;"演算子は、AのバウンディングボックスがBのバウンディングボックスとオーバラップしているか左側にある場合にTRUEを返します。</p></dd><dt><span class="term">A &amp;&gt; B</span></dt><dd><p>"&amp;&gt;"演算子は、AのバウンディングボックスがBのバウンディングボックスとオーバラップしているか右側にある場合にTRUEを返します。</p></dd><dt><span class="term">A &lt;&lt; B</span></dt><dd><p>"&lt;&lt;"演算子は、Aのバウンディングボックスが厳密にBのバウンディングボックスの左側にある場合にTRUEを返します。</p></dd><dt><span class="term">A &gt;&gt; B</span></dt><dd><p>"&gt;&gt;"演算子はAのバウンディングボックスが厳密にBンバウンディングボックスの右側にある場合にTRUEを返します。</p></dd><dt><span class="term">A &amp;&lt;| B</span></dt><dd><p>"&amp;&lt;|"演算子は、AのバウンディングボックスがBのバウンディングボックスとオーバラップしているか下にある場合にTRUEを返します。</p></dd><dt><span class="term">A |&amp;&gt; B</span></dt><dd><p>"|&amp;&gt;"演算子は、AのバウンディングボックスがBのバウンディングボックスとオーバラップしているか上にある場合にTRUEを返します。</p></dd><dt><span class="term">A &lt;&lt;| B</span></dt><dd><p>"&lt;&lt;|"演算子は、Aのバウンディングボックスが厳密にBのバウンディングボックスの下にある場合にTRUEを返します。</p></dd><dt><span class="term">A |&gt;&gt; B</span></dt><dd><p>"|&gt;&gt;"演算子は、Aのバウンディングボックスが厳密にBのバウンディングボックスの上にある場合にTRUEを返します。</p></dd><dt><span class="term">A ~= B</span></dt><dd><p>"~="演算子は、「同じ形のもの」演算子です。 二つのジオメトリが実際に幾何学的に等価であるかどうかを見ます。AとBが頂点ごとに見て同じフィーチャーの場合にTRUEを返します。</p></dd><dt><span class="term">A @ B</span></dt><dd><p>"@"演算子は、Aのバウンディングボックスが完全にBのバウンディングボックスに含まれる場合にTRUEを返します。</p></dd><dt><span class="term">A ~ B</span></dt><dd><p>"~"演算子は、Aのバウンディングボックスが完全にBのバウンディングボックスを含む場合にTRUEを返します。</p></dd><dt><span class="term">A &amp;&amp; B</span></dt><dd><p>"&amp;&amp;"演算子は、オーバラップ演算子です。AのバウンディングボックスがBのバウンディングボックスをオーバラップする場合にTRUEを返します。</p></dd></dl></div></div><div class="sect2" title="6.2.3. 計測関数"><div class="titlepage"><div><div><h3 class="title"><a name="idp64023752"></a>6.2.3. 計測関数</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">area2d(geometry)</span></dt><dd><p>ジオメトリがポリゴンかマルチポリゴンならジオメトリの面積を返します。</p></dd><dt><span class="term">distance_sphere(point, point)</span></dt><dd><p>緯度経度で示された二点の直線距離をメートルで返します。半径6370986メートルの球体とします。<a class="link" href="ch06.html#distance_spheroid">distance_spheroid()</a>より早いですが、精度は落ちます。ポイントについてのみ実装しています。</p></dd><dt><a name="distance_spheroid"></a><span class="term">distance_spheroid(point, point, spheroid)</span></dt><dd><p>指定した楕円体を使って、緯度経度で示された2点の直線距離をメートルで返します。<a class="link" href="ch06.html#length_spheroid">length_spheroid()</a>にある楕円体の説明をご覧下さい。現在は、ポイントについてのみ実装しています。</p></dd><dt><span class="term">length2d(geometry)</span></dt><dd><p>ラインストリングまたはマルチラインストリングの場合に、ジオメトリの2次元の長さを返します。</p></dd><dt><span class="term">length3d(geometry)</span></dt><dd><p>ラインストリングまたはマルチラインストリングの場合に、ジオメトリの3次元の長さを返します。</p></dd><dt><a name="length_spheroid"></a><span class="term">length_spheroid(geometry,spheroid)</span></dt><dd><p>楕円体上の長さを計算します。この関数は、ジオメトリの座標が緯度経度単位であって、投影変換なしに長さを求めたい場合に有用です。楕円体は別々のデータベースタイプで、次のように構成することができます。</p><div class="literallayout"><p>SPHEROID[&lt;名称&gt;,&lt;長軸半径&gt;,&lt;扁平率の逆数&gt;]</p></div><p>Eg:</p><div class="literallayout"><p>SPHEROID["GRS_1980",6378137,298.257222101]</p></div><p>計算例は次のようになるでしょう。</p><div class="literallayout"><p>SELECT<br>
 length_spheroid(<br>
  geometry_column,<br>
  'SPHEROID["GRS_1980",6378137,298.257222101]'<br>
 )<br>
FROM geometry_table;</p></div></dd><dt><span class="term">length3d_spheroid(geometry,spheroid)</span></dt><dd><p>ジオメトリの楕円体上の長さを、標高を考慮して計算します。この関数は、鉛直変動によって加えられる距離を計算するために鉛直座標 (楕円体の軸と同じ単位です)を使うことを除くと、ちょうどlength_spheroidに似ています。</p></dd><dt><span class="term">distance(geometry, geometry)</span></dt><dd><p>二つのジオメトリ間の最短距離を返します。</p></dd><dt><span class="term">max_distance(linestring,linestring)</span></dt><dd><p>二つのラインストリング間の最長距離を返します。</p></dd><dt><span class="term">perimeter(geometry)</span></dt><dd><p>POLYGONまたはMULTIPOLYGONジオメトリの場合に、2次元周囲長を返します。</p></dd><dt><span class="term">perimeter2d(geometry)</span></dt><dd><p>POLYGONまたはMULTIPOLYGONジオメトリの場合に、2次元周囲長を返します。</p></dd><dt><span class="term">perimeter3d(geometry)</span></dt><dd><p>POLYGONまたはMULTIPOLYGONジオメトリの場合には、3次元周囲長を返します。</p></dd></dl></div></div><div class="sect2" title="6.2.4. ジオメトリ出力"><div class="titlepage"><div><div><h3 class="title"><a name="idp64047688"></a>6.2.4. ジオメトリ出力</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">AsBinary(geometry,{'NDR'|'XDR'})</span></dt><dd><p>リトルエンディアン(NDR)またはビッグエンディアン(XDR)を使ったOGC "Well-known-binary"表現をbytea型で返します。この関数は、データをデータベース外に文字列表現を使わずに持ち出すバイナリカーソルで有用です。</p></dd><dt><span class="term">AsEWKT(geometry)</span></dt><dd><p>ジオメトリのEWKT表現をTEXT型で返します。</p></dd><dt><span class="term">AsEWKB(geometry, {'NDR'|'XDR'})</span></dt><dd><p>リトルエンディアン (NDR)またはビッグエンディアン (XDR)を使ったEWKB表現をbytea型で返します。</p></dd><dt><span class="term">AsSVG(geometry, [rel], [precision])</span></dt><dd><p>ジオメトリをSVGパスデータで返します。第2引数に1を指定すると、相対移動によるパスデータ実装を返します。デフォルト (または0指定)では、絶対移動を使います。第3引数は、出力の十進数の最大桁数を減らすために使います (デフォルトは15です)。'rel'が0のときはポイントはcx/cyに、'rel'が1のときはx/yに、それぞれ出力します。</p></dd><dt><span class="term">AsGML(geometry, [precision])</span></dt><dd><p>ジオメトリをGMLエレメントで返します。第2引数は、出力の最大有効桁数を減らすために使います (デフォルトは15です)。</p></dd></dl></div></div><div class="sect2" title="6.2.5. ジオメトリ コンストラクタ"><div class="titlepage"><div><div><h3 class="title"><a name="idp64077128"></a>6.2.5. ジオメトリ コンストラクタ</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">GeomFromEWKT(text)</span></dt><dd><p>EWKBからジオメトリを生成します。</p></dd><dt><span class="term">GeomFromEWKB(bytea)</span></dt><dd><p>EWKBからジオメトリを生成します。</p></dd><dt><span class="term">MakePoint(&lt;x&gt;, &lt;y&gt;, [&lt;z&gt;], [&lt;m&gt;])</span></dt><dd><p>2次元、3次元、4次元のポイントジオメトリを生成します。</p></dd><dt><span class="term">MakePointM(&lt;x&gt;, &lt;y&gt;, &lt;m&gt;)</span></dt><dd><p>XYMのポイントジオメトリを生成します。</p></dd><dt><span class="term">MakeBox2D(&lt;LL&gt;, &lt;UR&gt;)</span></dt><dd><p>与えられたポイントジオメトリから定義されるBOX2Dを生成します。</p></dd><dt><span class="term">MakeBox3D(&lt;LLB&gt;, &lt;URT&gt;)</span></dt><dd><p>与えられた3次元ポイントジオメトリから定義されるBOX3Dを生成します。</p></dd><dt><span class="term">MakeLine(geometry set)</span></dt><dd><p>ポイントジオメトリの集合からラインストリングをひとつ生成します。この集計関数に渡す前に、副問い合わせでポイントを並べ替えると良いかも知れません。</p></dd><dt><span class="term">MakeLine(geometry, geometry)</span></dt><dd><p>与えられた二つのポイントからラインストリングを生成します。</p></dd><dt><span class="term">LineFromMultiPoint(multipoint)</span></dt><dd><p>マルチポイントジオメトリからラインストリングを生成します。</p></dd><dt><span class="term">AddPoint(linestring, point, [&lt;position&gt;])</span></dt><dd><p>ポイントを、ラインストリングの&lt;pos&gt;の位置に追加します。第3引数を省略するか-1を設定すると、末尾に追加します。 </p></dd><dt><span class="term">MakePolygon(linestring, [linestring[]])</span></dt><dd><p>与えられた外周、穴の配列で形作られるポリゴンを生成します。ジオメトリ配列は<a class="link" href="ch06.html#Accum">Accum</a>を使って生成します。 入力ジオメトリは閉じたラインストリングである必要があります (<a class="link" href="ch06.html#IsClosed">IsClosed</a>と<a class="link" href="ch06.html#GeometryType">GeometryType</a>を参照して下さい)。 </p></dd><dt><span class="term">Polygonize(geometry set)</span></dt><dd><p>Aggregate. Creates a GeometryCollection containing possible polygons formed from the costituent linework of a set of geometries. Only available when compiled against GEOS 
&gt;= 2.1.0.</p></dd><dt><span class="term">Collect(geometry set)</span></dt><dd><p>ジオメトリの集合からジオメトリコレクションまたはマルチ系オブジェクトを返します。collect()関数はPostgreSQLの用語で言うところの「集計関数」です。これは、sum()やmean()関数と同じようにデータの複数行を扱うということを意味します。たとえば、"SELECT COLLECT(GEOM) FROM GEOMTABLE GROUP BY ATTRCOLUMN"は、ATTRCOLUMNの値ごとに分かれたジオメトリコレクションを返します。</p></dd><dt><span class="term">Collect(geometry, geometry)</span></dt><dd><p>二つの入力ジオメトリをまとめたジオメトリを返します。出力タイプはMULTI系またはGEOMETRYCOLLECTIONです。</p></dd><dt><span class="term">Dump(geometry)</span></dt><dd><p>これは集合を返す関数 (SRF=set-returning function)です。ジオメトリ (<code class="varname">geom</code>)と整数配列 (<code class="varname">path</code>)で作られる<code class="varname">geometry_dump</code>行を返します。入力ジオメトリが単純型 (POINT,LINESTRING,POLYGON)の場合は、単一の行で返り、pathには空配列、geomには入力ジオメトリが入ります。入力ジオメトリがジオメトリコレクションまたはMULTI系の場合は、要素ごとの行で返り、pathはコレクション内の要素位置を表します。 </p><p>ご注意: この関数はPostgreSQL 7.2.xでビルドした場合には有効ではありません</p></dd></dl></div></div><div class="sect2" title="6.2.6. ジオメトリエディタ"><div class="titlepage"><div><div><h3 class="title"><a name="idp64104520"></a>6.2.6. ジオメトリエディタ</h3></div></div></div><div class="variablelist"><dl><dt><a name="addbbox"></a><span class="term">AddBBOX(geometry)</span></dt><dd><p>ジオメトリにバウンディングボックスを追加します。これにより、バウンディングボックスに基づく検索が早くなりますが、ジオメトリのサイズが大きくなります。</p></dd><dt><a name="dropbbox"></a><span class="term">DropBBOX(geometry)</span></dt><dd><p>ジオメトリからバウンディングボックスのキャッシュを削除します。この関数は、ジオメトリのサイズを減らしますが、バウンディングボックスを用いたクエリを遅くします。</p></dd><dt><span class="term">Force_collection(geometry)</span></dt><dd><p>ジオメトリをジオメトリコレクションに変換します。これはWKB表現を単純化するのに便利です。</p></dd><dt><a name="force_2d"></a><span class="term">Force_2d(geometry)</span></dt><dd><p>ジオメトリを「2次元モード」に強制させます。全ての出力表現はXY座標値のみを持つことになります。OGC準拠の出力 (OGCは2次元ジオメトリのみ策定しています)に強制するために使われます。</p></dd><dt><a name="force_3dz"></a><span class="term">Force_3dz(geometry), </span><span class="term">Force_3d(geometry)</span></dt><dd><p>ジオメトリをXYZモードに強制します。</p></dd><dt><a name="force_3dm"></a><span class="term">Force_3dm(geometry)</span></dt><dd><p>ジオメトリをXYMモードに強制します。</p></dd><dt><a name="force_4d"></a><span class="term">Force_4d(geometry)</span></dt><dd><p>ジオメトリをXYZMモードに強制します。</p></dd><dt><span class="term">Multi(geometry)</span></dt><dd><p>マルチ系ジオメトリを返します。ジオメトリが既にマルチ系なら変更せずに返します。</p></dd><dt><span class="term">Transform(geometry,integer)</span></dt><dd><p>新しいジオメトリを整数値で参照されるSRIDに座標変換します。変換先SRIDは<code class="varname">SPATIAL_REF_SYS</code>テーブルに存在するものでなければなりません。</p></dd><dt><span class="term">Translate(geometry,float8,float8,float8)</span></dt><dd><p>引数の数値をオフセットとして、ジオメトリを新しい位置に変換するものです。すなわち translate(geom,X,Y,Z) となります。</p></dd><dt><span class="term">Reverse(geometry)</span></dt><dd><p>ジオメトリの頂点の並びを逆順にして返します。</p></dd><dt><span class="term">ForceRHR(geometry)</span></dt><dd><p>コレクションのポリゴンを右回りに従わせます。</p></dd><dt><span class="term">Simplify(geometry, tolerance)</span></dt><dd><p>引数のジオメトリをDouglas-Peukerアルゴリズムを使って「単純化した」ものを返します。(マルチ)ラインと(マルチ)ポリゴンでないと実際には動作しませんが、安全にあらゆる種類のジオメトリを引数にできます。単純化はオブジェクトごとに実行されるものですから、ジオメトリコレクションをこの関数に送ることもできます。返されるジオメトリが単純性を失う可能性もあることにご注意ください(<a class="link" href="ch06.html#IsSimple">IsSimple</a>を参照して下さい)。</p></dd><dt><span class="term">SnapToGrid(geometry, originX, originY, sizeX, sizeY), </span><span class="term">SnapToGrid(geometry, sizeX, sizeY), </span><span class="term">SnapToGrid(geometry, size)</span></dt><dd><p>引数のジオメトリの全てのポイントを、定義された原点とセルサイズを持つグリッド上にスナップします。 同じセルに落ちた、連続するポイントを削除します。引数ジオメトリのジオメトリタイプを定義できないポイントしか残らなかった場合は、NULLを返します。コレクション内で崩壊したジオメトリはそこから削除されます。返されるジオメトリは単純性を失う可能性がありますのでご注意ください (<a class="link" href="ch06.html#IsSimple">IsSimple</a>を参照して下さい)。 </p></dd><dt><span class="term">Segmentize(geometry, maxlength)</span></dt><dd><p>与えられた距離を超えるセグメントを持たないように変更されたジオメトリを返します。差し込まれたポイントはZとM値を (必要なら)持ち、値は0に設定されます。距離計算は2次元でのみ行います。</p></dd></dl></div></div><div class="sect2" title="6.2.7. その他の関数"><div class="titlepage"><div><div><h3 class="title"><a name="idp64132168"></a>6.2.7. その他の関数</h3></div></div></div><div class="variablelist"><dl><dt><span class="term">Summary(geometry)</span></dt><dd><p>ジオメトリについての要約文を返します。</p></dd><dt><span class="term">box2d(geometry)</span></dt><dd><p>ジオメトリの最大範囲を表すBOX2Dを返します。</p></dd><dt><span class="term">box3d(geometry)</span></dt><dd><p>ジオメトリの最大範囲を表すBOX3Dを返します。</p></dd><dt><span class="term">extent(geometry set)</span></dt><dd><p>extent()関数はPostgreSQL用語で言うところの「集計関数」です。これは、sum()やmean()と同じ方法でデータリストの操作を行うことを意味します。たとえば、"SELECT EXTENT(GEOM) FROM GEOMTABLE"は、テーブル内の全てのフィーチャーの最大範囲を示すBOX3Dを返します。同様に、"SELECT EXTENT(GEOM) FROM GEOMTABLE GROUP BY CATEGORY"は、カテゴリごとの範囲を返します。</p></dd><dt><a name="zmflag"></a><span class="term">zmflag(geometry)</span></dt><dd><p>ジオメトリのZM (次元の意味)フラグをsmall intで返します。値は、0=2次元, 1=M-三次元, 2=Z-3次元, 3=4次元です。 </p></dd><dt><a name="hasbbox"></a><span class="term">HasBBOX(geometry)</span></dt><dd><p>このジオメトリのバウンディングボックスがキャッシュされている場合はTRUEを返し、それ以外の場合はFALSEを返します。キャッシュ制御には<a class="link" href="ch06.html#addbbox">addBBOX()</a>と<a class="link" href="ch06.html#dropbbox">dropBBOX()</a>を使います。</p></dd><dt><a name="ndims"></a><span class="term">ndims(geometry)</span></dt><dd><p>ジオメトリの座標次元をsmall intで返します。値は2, 3, 4のいずれかです。</p></dd><dt><span class="term">nrings(geometry)</span></dt><dd><p>ジオメトリがポリゴンまたはマルチポリゴンの場合、リング数を返します。</p></dd><dt><span class="term">npoints(geometry)</span></dt><dd><p>ジオメトリのポイント (頂点)数を返します。</p></dd><dt><a name="IsValid"></a><span class="term">isvalid(geometry)</span></dt><dd><p>ジオメトリが妥当な場合にはTRUEを返します。</p></dd><dt><span class="term">expand(geometry, float)</span></dt><dd><p>入力ジオメトリのバウンディングボックスから、第2引数で指定される量によって、全ての方向に拡大させたバウンディングボックスを返します。 クエリにインデックスフィルタを追加するdistance()クエリにとても便利です。</p></dd><dt><span class="term">estimated_extent([schema], table, geocolumn)</span></dt><dd><p>与えられた空間テーブルの「見積もられた」範囲を返します。ジオメトリカラムの統計情報から見積もります。指定されていない場合は現在のスキーマが使われます。</p><p>PostgreSQL 8.0.0以上では、統計情報はVACUUM ANALYZEで集められ、結果の範囲は実際の約95%です。</p><p>PostgreSQL 8.0.0より前では、統計情報はupdate_geometry_stats()で集められ、範囲は確実です。</p></dd><dt><span class="term">find_srid(varchar,varchar,varchar)</span></dt><dd><p>この関数の書式はfind_srid(a_db_schema, a_table, a_column)です。GEOMETRY_COLUMNSで検索して、指定したカラムのSRID整数値を返します。ジオメトリカラムがAddGeometryColumn()関数で確実に追加していない場合には、確実には動作しません (訳注: GEOMETRY_COLUMNSビューで確実な登録が確認できていれば良いです)。</p></dd><dt><span class="term">mem_size(geometry)</span></dt><dd><p>ジオメトリが取る容量 (バイト単位)を返します。</p></dd><dt><span class="term">numb_sub_objects(geometry)</span></dt><dd><p>ジオメトリに格納されているオブジェクトの数を返します。マルチ系ジオメトリとジオメトリコレクションに使えます。</p></dd><dt><span class="term">point_inside_circle(geometry,float,float,float)</span></dt><dd><p>この関数の書式はpoint_inside_circle(&lt;geometry&gt;,&lt;circle_center_x&gt;,&lt;circle_center_y&gt;,&lt;radius&gt;)です。ジオメトリがポイントで、かつ指定した円内にある場合はTRUEを返し、それ以外はFALSEを返します。</p></dd><dt><span class="term">xmin(box3d) ymin(box3d) zmin(box3d)</span></dt><dd><p>バウンディングボックスの、それぞれX,Y,Z軸の最小値を返します。</p></dd><dt><span class="term">xmax(box3d) ymax(box3d) zmax(box3d)</span></dt><dd><p>バウンディングボックスの、それぞれX,Y,Z軸の最大値を返します。</p></dd><dt><span class="term">line_interpolate_point(geometry, proportion)</span></dt><dd><p>線に沿った内挿点を返します。第1引数はLINESTRINGでなければなりません。 第2引数は、float型で0から1の区間にある数です。ポイントを返します。</p></dd><dt><a name="Accum"></a><span class="term">Accum(geometry set)</span></dt><dd><p>集約関数です。ジオメトリの配列を生成します。</p></dd></dl></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch05.html">戻る</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="apa.html">次へ</a></td></tr><tr><td width="40%" align="left" valign="top">第5章 性能向上に関する技法 </td><td width="20%" align="center"><a accesskey="h" href="index.html">ホーム</a></td><td width="40%" align="right" valign="top"> 付録A リリースノート</td></tr></table></div></body></html>
