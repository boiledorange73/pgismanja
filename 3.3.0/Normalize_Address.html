<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>Normalize_Address</title><link rel="stylesheet" type="text/css" href="docbook.css"><link rel="stylesheet" type="text/css" href="style.css"><meta name="generator" content="DocBook XSL Stylesheets V1.79.1"><link rel="home" href="index.html" title="PostGIS 3.3.0 マニュアル"><link rel="up" href="Extras.html#Tiger_Geocoder" title="14.2. Tigerジオコーダ"><link rel="prev" href="Missing_Indexes_Generate_Script.html" title="Missing_Indexes_Generate_Script"><link rel="next" href="Pagc_Normalize_Address.html" title="Pagc_Normalize_Address"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">Normalize_Address</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="Missing_Indexes_Generate_Script.html">Prev</a> </td><th width="60%" align="center">14.2. Tigerジオコーダ</th><td width="20%" align="right"> <a accesskey="n" href="Pagc_Normalize_Address.html">Next</a></td></tr></table></div><div class="refentry"><a name="Normalize_Address"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>Normalize_Address — 文字列で住所が与えられると、道路後置辞、前置辞、正規化された種別、番地、ストリート名等をフィールドに分けて持つ<code class="varname">norm_addy</code>複合型を返します。tiger_geocoderに同梱されているルックアップデータで動作します (Tigerデータ自体は不要です)。</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="funcsynopsis"><p><code class="funcdef">norm_addy <b class="fsfunc">normalize_address</b>(</code>varchar  <var class="pdparam">in_address</var><code>)</code>;</p></div></div><div class="refsection"><a name="idp93227088"></a><h2>説明</h2><p>文字列で住所が与えられると、道路後置辞、前置辞、正規化された種別、番地、ストリート名等をフィールドに分けて持つ<code class="varname">norm_addy</code>複合型を返します。全ての住所を正規化した郵便形式にするジオコーディング処理の第一段階です。ジオコーダに同梱されるもの以外で必要な者はありません。</p><p>tiger_geocoderによって前もってロードされ、<code class="varname">tiger</code>スキーマに格納される、様々な方角/州/後置辞のルックアップテーブルを使います。よって、Tigerデータをダウンロードしたり、追加データをする必要はありません。<code class="varname">tiger</code>スキーマ内のルックアップテーブルに略語や別名の追加が必要になることがあります。</p><p><code class="varname">tiger</code>スキーマ内に、入力アドレスを正規化するための、多様な制御ルックアップテーブルを使います。</p><p>この関数が返す<code class="varname">norm_addy</code>型オブジェクトのフィールドは、次に示す順序です。()はジオコーダの必須フィールド、[]は任意フィールドです。</p><p>(address) [predirAbbrev] (streetName) [streetTypeAbbrev] [postdirAbbrev] [internal] [location] [stateAbbrev] [zip] [parsed] [zip4] [address_alphanumeric]</p><p>Enhanced: 2.4.0 norm_addyオブジェクトには追加フィールドのzip4とaddress_alphanumericとが含まれます。</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p><code class="varname">address</code> 整数: 番地</p></li><li class="listitem"><p><code class="varname">predirAbbrev</code> varchar型: N, S, E, W等といった道路の方向前置辞。<code class="varname">direction_lookup</code>テーブルに制御されます。</p></li><li class="listitem"><p><code class="varname">streetName</code> varchar型</p></li><li class="listitem"><p><code class="varname">streetTypeAbbrev</code> varchar型 ストリート種別の短縮名: St, Ave, Cir等。<code class="varname">street_type_lookup</code>テーブルに制御されます。</p></li><li class="listitem"><p><code class="varname">postdirAbbrev</code> varchar型 N, S, E, W等の道路名の方向後置辞。<code class="varname">direction_lookup</code>テーブルに制御されます。</p></li><li class="listitem"><p><code class="varname">internal</code> varchar型 部屋番号といった内部住所。</p></li><li class="listitem"><p><code class="varname">location</code> varchar型 通常は市名や県名です。</p></li><li class="listitem"><p><code class="varname">stateAbbrev</code> varchar型 MA, NY, MI等のような米国の州名の2文字表示です。<code class="varname">state_lookup</code>テーブルに制御されます。</p></li><li class="listitem"><p><code class="varname">zip</code> varchar型 02109等の5桁の数字です。</p></li><li class="listitem"><p><code class="varname">parsed</code> 真偽型 - 住所が正規化処理で整形されたかを示します。normalize_addressは、住所を返す前にこれをTRUEにします。</p></li><li class="listitem"><p><code class="varname">zip4</code> 9桁郵便番号の後半4桁です。Availability: PostGIS 2.4.0。</p></li><li class="listitem"><p><code class="varname">address_alphanumeric</code> 17Rのような文字を含む完全なストリート番号。これの解析は<a class="xref" href="Pagc_Normalize_Address.html" title="Pagc_Normalize_Address">Pagc_Normalize_Address</a>関数を使うと良くなります。 Availability: PostGIS 2.4.0。</p></li></ol></div></div><div class="refsection"><a name="idp93251280"></a><h2>例</h2><p>フィールドを選択して出力します。きれいな文字列を求める場合には、<a class="xref" href="Pprint_Addy.html" title="Pprint_Addy">Pprint_Addy</a>を使います。</p><pre class="programlisting">SELECT address As orig, (g.na).streetname, (g.na).streettypeabbrev
 FROM (SELECT address, normalize_address(address) As na
        FROM addresses_to_geocode) As g;

                        orig                         |  streetname   | streettypeabbrev
-----------------------------------------------------+---------------+------------------
 28 Capen Street, Medford, MA                        | Capen         | St
 124 Mount Auburn St, Cambridge, Massachusetts 02138 | Mount Auburn  | St
 950 Main Street, Worcester, MA 01610                | Main          | St
 529 Main Street, Boston MA, 02129                   | Main          | St
 77 Massachusetts Avenue, Cambridge, MA 02139        | Massachusetts | Ave
 25 Wizard of Oz, Walaford, KS 99912323              | Wizard of Oz  |
        </pre></div><div class="refsection"><a name="idp93253584"></a><h2>関連情報</h2><p><a class="xref" href="Geocode.html" title="Geocode">Geocode</a>, <a class="xref" href="Pprint_Addy.html" title="Pprint_Addy">Pprint_Addy</a></p></div></div><div class="navfooter"><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="Missing_Indexes_Generate_Script.html">Prev</a> </td><td width="20%" align="center"><a accesskey="u" href="Extras.html#Tiger_Geocoder">Up</a></td><td width="40%" align="right"> <a accesskey="n" href="Pagc_Normalize_Address.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Missing_Indexes_Generate_Script </td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right" valign="top"> Pagc_Normalize_Address</td></tr></table></div></body></html>
