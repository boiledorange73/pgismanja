<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>ST_Union</title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.1"><link rel="home" href="index.html" title="PostGIS 1.5.1 &#12510;&#12491;&#12517;&#12450;&#12523; &#26085;&#26412;&#35486;&#35379;"><link rel="up" href="reference.html#Geometry_Processing" title="7.9. &#12472;&#12458;&#12513;&#12488;&#12522;&#20966;&#29702;&#38306;&#25968;"><link rel="prev" href="ST_SymDifference.html" title="ST_SymDifference"><link rel="next" href="ST_Line_Interpolate_Point.html" title="ST_Line_Interpolate_Point"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">ST_Union</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ST_SymDifference.html">&#21069;&#12398;&#12506;&#12540;&#12472;</a> </td><th width="60%" align="center">7.9. 
		&#12472;&#12458;&#12513;&#12488;&#12522;&#20966;&#29702;&#38306;&#25968;
		
		</th><td width="20%" align="right"> <a accesskey="n" href="ST_Line_Interpolate_Point.html">&#27425;&#12398;&#12506;&#12540;&#12472;</a></td></tr></table><hr></div><div class="refentry" title="ST_Union"><a name="ST_Union"></a><div class="titlepage"></div><div class="refnamediv"><h2>&#21517;&#21069;</h2><p>ST_Union &#8212; 
	&#12472;&#12458;&#12513;&#12488;&#12522;&#32080;&#21512;&#12398;&#28857;&#38598;&#21512;&#12434;&#34920;&#29694;&#12377;&#12427;&#12472;&#12458;&#12513;&#12488;&#12522;&#12434;&#36820;&#12375;&#12414;&#12377;&#65294;
	
		</p></div><div class="refsynopsisdiv" title="&#27010;&#35201;"><h2>&#27010;&#35201;</h2><div class="funcsynopsis"><p><code class="funcdef">geometry <b class="fsfunc">ST_Union</b>(</code>geometry set <var class="pdparam">g1field</var><code>)</code>;</p><p><code class="funcdef">geometry <b class="fsfunc">ST_Union</b>(</code>geometry <var class="pdparam">g1</var>, geometry <var class="pdparam">g2</var><code>)</code>;</p><p><code class="funcdef">geometry <b class="fsfunc">ST_Union</b>(</code>geometry[] <var class="pdparam">g1_array</var><code>)</code>;</p></div></div><div class="refsection" title="&#35500;&#26126;"><a name="id286900379"></a><h2>&#35500;&#26126;</h2><p>
	MULTI&#31995;&#65292;&#21336;&#19968;&#12472;&#12458;&#12513;&#12488;&#12522;&#65292;&#12472;&#12458;&#12513;&#12488;&#12522;&#12467;&#12524;&#12463;&#12471;&#12519;&#12531;&#12398;&#12356;&#12378;&#12428;&#12391;&#12418;&#20986;&#21147;&#12373;&#12428;&#12414;&#12377;&#65294;
	&#20108;&#12388;&#12398;&#24418;&#24335;&#12364;&#12354;&#12426;&#12414;&#12377;&#65294;&#19968;&#12388;&#30446;&#12391;&#12399;&#20108;&#12388;&#12398;&#12472;&#12458;&#12513;&#12488;&#12522;&#12363;&#12425;&#12452;&#12531;&#12479;&#12475;&#12463;&#12488;&#12375;&#12390;&#12356;&#12427;&#38936;&#22495;&#12398;&#28961;&#12356;&#26032;&#12375;&#12356;&#12472;&#12458;&#12513;&#12488;&#12522;&#12434;&#36820;&#12375;&#12414;&#12377;&#65294;
	&#20108;&#12388;&#30446;&#12391;&#12399;&#65292;&#12472;&#12458;&#12513;&#12488;&#12522;&#12398;&#38598;&#21512;&#12434;&#21462;&#12426;&#65292;&#12452;&#12531;&#12479;&#12475;&#12463;&#12488;&#12375;&#12390;&#12356;&#12427;&#38936;&#22495;&#12398;&#28961;&#12356;&#21336;&#19968;&#12398;ST_Geometry&#12434;&#36820;&#12375;&#12414;&#12377;&#65294;
	
		</p><p>
	&#38598;&#35336;&#38306;&#25968;&#29256;: &#12371;&#12398;&#38306;&#25968;&#12399;&#65292;&#12472;&#12458;&#12513;&#12488;&#12522;&#12398;&#38598;&#21512;&#12363;&#12425;&#65292;MULTI&#31995;&#12472;&#12458;&#12513;&#12488;&#12522;&#12414;&#12383;&#12399;&#38750;MULTI&#31995;&#12472;&#12458;&#12513;&#12488;&#12522;&#12434;&#36820;&#12375;&#12414;&#12377;&#65294;ST_Union()&#38306;&#25968;&#12399;&#65292;PostgreSQL&#29992;&#35486;&#12391;&#35328;&#12358;&#12392;&#12371;&#12429;&#12398;&#12300;&#38598;&#35336;&#38306;&#25968;&#12301;&#12391;&#12377;&#65294;SUM()&#12420;MEAN()&#12392;&#21516;&#12376;&#26041;&#27861;&#12391;&#12487;&#12540;&#12479;&#12522;&#12473;&#12488;&#12398;&#25805;&#20316;&#12434;&#34892;&#12358;&#12371;&#12392;&#12434;&#24847;&#21619;&#12375;&#12414;&#12377;&#65294; 
	
	
		</p><p>
	&#38750;&#38598;&#35336;&#38306;&#25968;&#29256;: &#12371;&#12398;&#38306;&#25968;&#12399;&#20108;&#12388;&#12398;&#20837;&#21147;&#12472;&#12458;&#12513;&#12488;&#12522;&#12398;&#32080;&#21512;&#12375;&#12383;&#12472;&#12458;&#12513;&#12488;&#12522;&#12434;&#36820;&#12375;&#12414;&#12377;&#65294;&#20986;&#21147;&#22411;&#12399;MULTI&#31995;&#65292;&#38750;MULTI&#31995;&#12414;&#12383;&#12399;GEOMETRYCOLLECTION&#12391;&#12377;&#65294;
	
		</p><div class="note" title="&#27880;&#24847;" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[&#27880;&#24847;]" src="images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
	ST_Collect&#12392;ST_Union&#12399;&#12375;&#12400;&#12375;&#12400;&#20132;&#25563;&#12375;&#12390;&#20351;&#12358;&#12371;&#12392;&#12364;&#12391;&#12365;&#12414;&#12377;&#65294; ST_Union&#12399;&#12496;&#12454;&#12531;&#12480;&#12522;&#12434;&#26356;&#26032;&#12375;&#12424;&#12358;&#12392;&#12377;&#12427;&#12398;&#12391;&#65292;&#19968;&#33324;&#30340;&#12395;ST_Collect&#12424;&#12426;&#12418;&#26689;&#36949;&#12356;&#12395;&#36933;&#12367;&#21205;&#12365;&#12414;&#12377;&#65294; ST_Collect&#12399;&#65292;&#21336;&#12395;&#65292;&#12471;&#12531;&#12464;&#12523;&#12472;&#12458;&#12513;&#12488;&#12522;&#12434;MULTI&#31995;&#12472;&#12458;&#12513;&#12488;&#12522;&#12395;&#24059;&#12365;&#36796;&#12415;&#65292;MULTI&#31995;&#12472;&#12458;&#12513;&#12488;&#12522;&#12414;&#12383;&#12399;&#12472;&#12458;&#12513;&#12488;&#12522;&#22411;&#28151;&#22312;&#12398;&#38598;&#21512;&#12434;&#12472;&#12458;&#12513;&#12488;&#12522;&#12467;&#12524;&#12463;&#12471;&#12519;&#12531;&#12395;&#24059;&#12365;&#36796;&#12416;&#65292;&#12392;&#12356;&#12358;&#12371;&#12392;&#12434;&#34892;&#12387;&#12390;&#12356;&#12427;&#12384;&#12369;&#12391;&#12377;&#65294; 
	
		</p></td></tr></table></div><p>GEOS&#12514;&#12472;&#12517;&#12540;&#12523;&#12391;&#23455;&#34892;&#12375;&#12390;&#12356;&#12414;&#12377;</p><p>
	&#12372;&#27880;&#24847;: &#12371;&#12398;&#38306;&#25968;&#12399;&#20197;&#21069;&#12399;&#65292;"Union"&#12363;&#12425;&#25913;&#21517;&#12375;&#12390;GeomUnion()&#12392;&#21628;&#12400;&#12428;&#12390;&#12356;&#12414;&#12375;&#12383;&#65294;UNION&#12399;SQL&#12398;&#20104;&#32004;&#35486;&#12391;&#12354;&#12427;&#12383;&#12417;&#12391;&#12377;&#65294;
	
		</p><p>
	&#21021;&#20986;&#12496;&#12540;&#12472;&#12519;&#12531;: 1.4.0 - ST_Union&#12364;&#24375;&#21270;&#12373;&#12428;&#12414;&#12375;&#12383;&#65294;ST_Union(geomarray)&#12364;&#23566;&#20837;&#12373;&#12428;&#65292;&#12414;&#12383;&#65292;PostgreSQL&#20869;&#12391;&#12398;&#38598;&#35336;&#12364;&#36895;&#12367;&#12394;&#12426;&#12414;&#12375;&#12383;&#65294;GEOS 3.1.0&#20197;&#19978;&#12434;&#20351;&#29992;&#12375;&#12390;&#12356;&#12427;&#22580;&#21512;&#12399;&#65292;ST_Union&#12399;&#65292;<a class="ulink" href="http://blog.cleverelephant.ca/2009/01/must-faster-unions-in-postgis-14.html" target="_top">http://blog.cleverelephant.ca/2009/01/must-faster-unions-in-postgis-14.html</a>&#12395;&#35352;&#36848;&#12364;&#12354;&#12427;&#65292;Cascaded Union&#12450;&#12523;&#12468;&#12522;&#12474;&#12512;&#12434;&#20351;&#12356;&#12414;&#12377;&#65294;
	
		</p><p><span class="inlinemediaobject"><img src="images/check.png"></span>
 &#12371;&#12398;&#12513;&#12477;&#12483;&#12489;&#12399; <a class="ulink" href="http://www.opengeospatial.org/standards/sfs" target="_top">OpenGIS Simple Features Implementation Specification for SQL 1.1.</a>&#12434;&#23455;&#35013;&#12377;&#12427;&#12418;&#12398;&#12391;&#12377;&#65294; s2.1.1.3</p><div class="note" title="&#27880;&#24847;" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[&#27880;&#24847;]" src="images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
	&#38598;&#32004;&#38306;&#25968;&#29256;&#12399;&#65292;OGC&#20181;&#27096;&#12395;&#26126;&#31034;&#30340;&#12395;&#23450;&#32681;&#12373;&#12428;&#12390;&#12356;&#12414;&#12379;&#12435;&#65294;
	
	</p></td></tr></table></div><p><span class="inlinemediaobject"><img src="images/check.png"></span> &#12371;&#12398;&#12513;&#12477;&#12483;&#12489;&#12399;SQL/MM&#20181;&#27096;&#12398;&#23455;&#35013;&#12391;&#12377;&#65294; SQL-MM 3: 5.1.19
		the z-index (elevation) when polygons are involved.</p></div><div class="refsection" title="&#20363;"><a name="id286900499"></a><h2>&#20363;</h2><p>
		&#38598;&#32004;&#38306;&#25968;&#29256;&#12398;&#20363;
		
		</p><pre class="programlisting">
SELECT stusps,
	   ST_Multi(ST_Union(f.the_geom)) as singlegeom
	 FROM sometable As f
GROUP BY stusps
			  </pre><p>Non-Aggregate example</p><pre class="programlisting">
SELECT ST_AsText(ST_Union(ST_GeomFromText('POINT(1 2)'),
	ST_GeomFromText('POINT(-2 3)') ) )

st_astext
----------
MULTIPOINT(-2 3,1 2)


SELECT ST_AsText(ST_Union(ST_GeomFromText('POINT(1 2)'),
		ST_GeomFromText('POINT(1 2)') ) );
st_astext
----------
POINT(1 2)

--3d example - sort of supports 3d (and with mixed dimensions!)
SELECT ST_AsEWKT(st_union(the_geom))
FROM
(SELECT ST_GeomFromEWKT('POLYGON((-7 4.2,-7.1 4.2,-7.1 4.3,
-7 4.2))') as the_geom
UNION ALL
SELECT ST_GeomFromEWKT('POINT(5 5 5)') as the_geom
UNION ALL
	SELECT ST_GeomFromEWKT('POINT(-2 3 1)') as the_geom
UNION ALL
SELECT ST_GeomFromEWKT('LINESTRING(5 5 5, 10 10 10)') as the_geom ) as foo;

st_asewkt
---------
GEOMETRYCOLLECTION(POINT(-2 3 1),LINESTRING(5 5 5,10 10 10),POLYGON((-7 4.2 5,-7.1 4.2 5,-7.1 4.3 5,-7 4.2 5)));

--3d example not mixing dimensions
SELECT ST_AsEWKT(st_union(the_geom))
FROM
(SELECT ST_GeomFromEWKT('POLYGON((-7 4.2 2,-7.1 4.2 3,-7.1 4.3 2,
-7 4.2 2))') as the_geom
UNION ALL
SELECT ST_GeomFromEWKT('POINT(5 5 5)') as the_geom
UNION ALL
	SELECT ST_GeomFromEWKT('POINT(-2 3 1)') as the_geom
UNION ALL
SELECT ST_GeomFromEWKT('LINESTRING(5 5 5, 10 10 10)') as the_geom ) as foo;

st_asewkt
---------
GEOMETRYCOLLECTION(POINT(-2 3 1),LINESTRING(5 5 5,10 10 10),POLYGON((-7 4.2 2,-7.1 4.2 3,-7.1 4.3 2,-7 4.2 2)))

--Examples using new Array construct
SELECT ST_Union(ARRAY(SELECT the_geom FROM sometable));

SELECT ST_AsText(ST_Union(ARRAY[ST_GeomFromText('LINESTRING(1 2, 3 4)'),
			ST_GeomFromText('LINESTRING(3 4, 4 5)')])) As wktunion;

--wktunion---
MULTILINESTRING((3 4,4 5),(1 2,3 4))

			  </pre></div><div class="refsection" title="&#38306;&#36899;&#24773;&#22577;"><a name="id286900523"></a><h2>&#38306;&#36899;&#24773;&#22577;</h2><p><a class="xref" href="ST_Collect.html" title="ST_Collect">ST_Collect</a></p></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ST_SymDifference.html">&#21069;&#12398;&#12506;&#12540;&#12472;</a> </td><td width="20%" align="center"><a accesskey="u" href="reference.html#Geometry_Processing">&#19978;&#12395;&#25147;&#12427;</a></td><td width="40%" align="right"> <a accesskey="n" href="ST_Line_Interpolate_Point.html">&#27425;&#12398;&#12506;&#12540;&#12472;</a></td></tr><tr><td width="40%" align="left" valign="top">ST_SymDifference </td><td width="20%" align="center"><a accesskey="h" href="index.html">&#12507;&#12540;&#12512;</a></td><td width="40%" align="right" valign="top"> ST_Line_Interpolate_Point</td></tr></table></div></body></html>
