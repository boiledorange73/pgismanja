<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>&#31532;5&#31456; PostGIS&#12434;&#20351;&#12358;: &#12450;&#12503;&#12522;&#12465;&#12540;&#12471;&#12519;&#12531;&#12434;&#27083;&#31689;&#12377;&#12427;</title><link rel="stylesheet" href="style.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.75.1"><link rel="home" href="index.html" title="PostGIS 1.5.1 &#12510;&#12491;&#12517;&#12450;&#12523; &#26085;&#26412;&#35486;&#35379;"><link rel="up" href="index.html" title="PostGIS 1.5.1 &#12510;&#12491;&#12517;&#12450;&#12523; &#26085;&#26412;&#35486;&#35379;"><link rel="prev" href="ch04.html" title="&#31532;4&#31456; PostGIS&#12434;&#20351;&#12358;: &#12487;&#12540;&#12479;&#31649;&#29702;&#12392;&#12463;&#12456;&#12522;"><link rel="next" href="ch06.html" title="&#31532;6&#31456; &#24615;&#33021;&#21521;&#19978;&#12395;&#38306;&#12377;&#12427;&#25216;&#27861;"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">&#31532;5&#31456; 
  PostGIS&#12434;&#20351;&#12358;: &#12450;&#12503;&#12522;&#12465;&#12540;&#12471;&#12519;&#12531;&#12434;&#27083;&#31689;&#12377;&#12427;
  
  </th></tr><tr><td width="20%" align="left"><a accesskey="p" href="ch04.html">&#21069;&#12398;&#12506;&#12540;&#12472;</a> </td><th width="60%" align="center"> </th><td width="20%" align="right"> <a accesskey="n" href="ch06.html">&#27425;&#12398;&#12506;&#12540;&#12472;</a></td></tr></table><hr></div><div class="chapter" title="&#31532;5&#31456; PostGIS&#12434;&#20351;&#12358;: &#12450;&#12503;&#12522;&#12465;&#12540;&#12471;&#12519;&#12531;&#12434;&#27083;&#31689;&#12377;&#12427;"><div class="titlepage"><div><div><h2 class="title"><a name="id286824791"></a>&#31532;5&#31456; 
  PostGIS&#12434;&#20351;&#12358;: &#12450;&#12503;&#12522;&#12465;&#12540;&#12471;&#12519;&#12531;&#12434;&#27083;&#31689;&#12377;&#12427;
  
  </h2></div></div></div><div class="toc"><p><b>&#30446;&#27425;</b></p><dl><dt><span class="sect1"><a href="ch05.html#Using_MapServer">5.1. 
	MapServer&#12434;&#20351;&#12358;
	
	</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch05.html#id286825254">5.1.1. 
	  &#22522;&#26412;&#30340;&#12394;&#20351;&#12356;&#26041;
	  
	  </a></span></dt><dt><span class="sect2"><a href="ch05.html#id286825465">5.1.2. 
	  &#12424;&#12367;&#12354;&#12427;&#36074;&#21839;
	  
	  </a></span></dt><dt><span class="sect2"><a href="ch05.html#id286825662">5.1.3. 
	  &#36367;&#12415;&#36796;&#12435;&#12384;&#20351;&#29992;&#27861;
	  
	  </a></span></dt><dt><span class="sect2"><a href="ch05.html#id286825778">5.1.4. 
	  &#20363;
	  
	  </a></span></dt></dl></dd><dt><span class="sect1"><a href="ch05.html#id286826022">5.2. 
	Java&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;(JDBC)
	
	</a></span></dt><dt><span class="sect1"><a href="ch05.html#id286826057">5.3. 
	C&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;(libpq)
	
	</a></span></dt><dd><dl><dt><span class="sect2"><a href="ch05.html#id286826068">5.3.1. 
	  &#12486;&#12461;&#12473;&#12488;&#12459;&#12540;&#12477;&#12523;
	  
	  </a></span></dt><dt><span class="sect2"><a href="ch05.html#id286826080">5.3.2. 
	  &#12496;&#12452;&#12490;&#12522;&#12459;&#12540;&#12477;&#12523;
	  
	  </a></span></dt></dl></dd></dl></div><div class="sect1" title="5.1. MapServer&#12434;&#20351;&#12358;"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Using_MapServer"></a>5.1. 
	MapServer&#12434;&#20351;&#12358;
	
	</h2></div></div></div><div class="toc"><dl><dt><span class="sect2"><a href="ch05.html#id286825254">5.1.1. 
	  &#22522;&#26412;&#30340;&#12394;&#20351;&#12356;&#26041;
	  
	  </a></span></dt><dt><span class="sect2"><a href="ch05.html#id286825465">5.1.2. 
	  &#12424;&#12367;&#12354;&#12427;&#36074;&#21839;
	  
	  </a></span></dt><dt><span class="sect2"><a href="ch05.html#id286825662">5.1.3. 
	  &#36367;&#12415;&#36796;&#12435;&#12384;&#20351;&#29992;&#27861;
	  
	  </a></span></dt><dt><span class="sect2"><a href="ch05.html#id286825778">5.1.4. 
	  &#20363;
	  
	  </a></span></dt></dl></div><p>
	MapServer&#12399;OpenGIS Web Mapping Server&#20181;&#27096;&#12434;&#28288;&#12383;&#12377;&#12454;&#12455;&#12502;&#12510;&#12483;&#12500;&#12531;&#12464;&#12469;&#12540;&#12496;&#12391;&#12377;&#65294;
	
	</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
		MapServer&#12398;&#12454;&#12455;&#12502;&#12469;&#12452;&#12488;&#12399; <a class="ulink" href="http://mapserver.org" target="_top">http://mapserver.org</a> &#12391;&#12377;&#65294;
		
		</p></li><li class="listitem"><p>
		OpenGIS Web Map Specivication&#12399; <a class="ulink" href="http://www.opengeospatial.org/standards/wms" target="_top">http://www.opengeospatial.org/standards/wms</a> &#12395;&#12354;&#12426;&#12414;&#12377;&#65294;
		
		</p></li></ul></div><div class="sect2" title="5.1.1. &#22522;&#26412;&#30340;&#12394;&#20351;&#12356;&#26041;"><div class="titlepage"><div><div><h3 class="title"><a name="id286825254"></a>5.1.1. 
	  &#22522;&#26412;&#30340;&#12394;&#20351;&#12356;&#26041;
	  
	  </h3></div></div></div><p>
	  MapServer&#12391;PostGIS&#12434;&#20351;&#12358;&#12395;&#12399;&#65292;MapServer&#12398;&#12467;&#12531;&#12501;&#12451;&#12462;&#12517;&#12524;&#12540;&#12471;&#12519;&#12531;&#26041;&#27861;&#12395;&#12388;&#12356;&#12390;&#24517;&#35201;&#12391;&#12377;&#12364;&#65292;&#12371;&#12398;&#25991;&#26360;&#12398;&#31684;&#22258;&#22806;&#12391;&#12377;&#65294;&#12371;&#12398;&#31680;&#12391;&#12399;&#65292;PostGIS&#29305;&#26377;&#12398;&#21839;&#38988;&#12392;&#12467;&#12531;&#12501;&#12451;&#12462;&#12517;&#12524;&#12540;&#12471;&#12519;&#12531;&#35443;&#32048;&#12434;&#12459;&#12496;&#12540;&#12375;&#12414;&#12377;&#65294;  
	  
	  </p><p>
	  PostGIS&#12434;MapServer&#12391;&#20351;&#12358;&#12395;&#12399;&#65292;&#27425;&#12398;&#12371;&#12392;&#12364;&#24517;&#35201;&#12391;&#12377;&#65294;
	  
	  </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>
		  PostGIS 0.6&#20197;&#19978;
		  
		  </p></li><li class="listitem"><p>
		  MapServer 3.5&#20197;&#19978;
		  
		  </p></li></ul></div><p>
	  MapServer&#12399;&#65292;&#20182;&#12398;PostgreSQL&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12398;&#12424;&#12358;&#12395;&#65292;<code class="filename">libpq</code>&#12452;&#12531;&#12479;&#12501;&#12455;&#12540;&#12473;&#12434;&#20351;&#12387;&#12390;&#65292;PostGIS/PostgreSQL&#12487;&#12540;&#12479;&#12395;&#12450;&#12463;&#12475;&#12473;&#12375;&#12414;&#12377;&#65294;&#12424;&#12387;&#12390;MapServer&#12399;PostGIS&#12469;&#12540;&#12496;&#12395;&#12450;&#12463;&#12475;&#12473;&#12377;&#12427;&#12493;&#12483;&#12488;&#12527;&#12540;&#12463;&#12434;&#25345;&#12388;&#35336;&#31639;&#27231;&#12395;&#12452;&#12531;&#12473;&#12488;&#12540;&#12523;&#12391;&#12365;&#65292;PostGIS&#12434;&#12487;&#12540;&#12479;&#12477;&#12540;&#12473;&#12392;&#12375;&#12390;&#20351;&#29992;&#12377;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12414;&#12377;&#65294;&#12471;&#12473;&#12486;&#12512;&#38291;&#12398;&#25509;&#32154;&#12399;&#36895;&#12356;&#12411;&#12393;&#33391;&#12356;&#12391;&#12377;&#65294;
	  
	  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
			  "--with-postgis"&#12392;&#22909;&#12365;&#12394;configure&#12458;&#12503;&#12471;&#12519;&#12531;&#12434;&#20184;&#12369;&#12390;Mpaserver&#12398;&#12467;&#12531;&#12497;&#12452;&#12523;&#12392;&#12452;&#12531;&#12473;&#12488;&#12540;&#12523;&#12434;&#34892;&#12356;&#12414;&#12377;&#65294;
		  
		  </p></li><li class="listitem"><p>
		  Mapserver&#12398;map&#12501;&#12449;&#12452;&#12523;&#12398;&#20013;&#12395;&#65292;PostGIS&#12524;&#12452;&#12516;&#12434;&#36861;&#21152;&#12375;&#12414;&#12377;&#65294;&#12383;&#12392;&#12360;&#12400;&#27425;&#12398;&#12424;&#12358;&#12395;&#12394;&#12426;&#12414;&#12377;&#65294;
		  
		  </p><pre class="programlisting">LAYER 
  CONNECTIONTYPE postgis 
  NAME "widehighways" 
  # &#12522;&#12514;&#12540;&#12488;&#12398;&#31354;&#38291;&#38651;&#20182;&#12505;&#12540;&#12473;&#12395;&#25509;&#32154;
  CONNECTION "user=dbuser dbname=gisdatabase host=bigserver"
  PROCESSING "CLOSE_CONNECTION=DEFER"
  # 'road'&#12486;&#12540;&#12502;&#12523;&#12398;'geom'&#12459;&#12521;&#12512;&#12363;&#12425;&#32218;&#12434;&#21462;&#24471;
  DATA "geom from roads using srid=4326 using unique gid" 
  STATUS ON
  TYPE LINE 
  # &#31684;&#22258;&#20869;&#12398;&#32218;&#12398;&#12358;&#12385;&#24195;&#12356;&#39640;&#36895;&#36947;&#36335;&#12398;&#12415;&#25551;&#30011;
  FILTER "type = 'highway' and numlanes &gt;= 4" 
  CLASS 
    # &#12473;&#12540;&#12497;&#12540;&#39640;&#36895;&#36947;&#36335;&#12399;&#65292;&#26126;&#12427;&#12367;&#12375;&#65292;2&#12500;&#12463;&#12475;&#12523;&#24133;&#12395;&#12377;&#12427;
    EXPRESSION ([numlanes] &gt;= 6) 
    STYLE
      COLOR 255 22 22 
      WIDTH 2 
    END
  END 
  CLASS 
    # &#27531;&#12426;&#12398;&#36947;&#36335;&#12399;&#65292;&#26263;&#12367;&#12375;&#65292;1&#12500;&#12463;&#12475;&#12523;&#24133;&#12395;&#12377;&#12427;
    EXPRESSION ([numlanes] &lt; 6) 
    STYLE
      COLOR 205 92 82
    END
  END 
END</pre><p>
		  &#19978;&#12398;&#20363;&#12395;&#12362;&#12369;&#12427;PostGIS&#29305;&#26377;&#12398;&#12487;&#12451;&#12524;&#12463;&#12486;&#12451;&#12502;&#12399;&#27425;&#12398;&#36890;&#12426;&#12391;&#12377;&#65294;
		  
		  </p><div class="variablelist"><dl><dt><span class="term">CONNECTIONTYPE</span></dt><dd><p>
				PostGIS&#12524;&#12452;&#12516;&#12395;&#12377;&#12427;&#12395;&#12399;&#65292;&#12371;&#12371;&#12399;&#24120;&#12395;"postgis"&#12395;&#12394;&#12426;&#12414;&#12377;&#65294;
				
				</p></dd><dt><span class="term">CONNECTION</span></dt><dd><p>
				&#12487;&#12540;&#12479;&#12505;&#12540;&#12473;&#25509;&#32154;&#12399;&#12300;&#25509;&#32154;&#25991;&#23383;&#21015;&#12301;&#12395;&#12424;&#12387;&#12390;&#21046;&#24481;&#12373;&#12428;&#12414;&#12377;&#65294;&#25509;&#32154;&#25991;&#23383;&#21015;&#12399;&#65292;&#27425;&#12395;&#31034;&#12377;&#12424;&#12358;&#12394;&#27161;&#28310;&#30340;&#12394;&#12461;&#12540;&#12392;&#20516;&#12363;&#12425;&#12394;&#12426;&#12414;&#12377;(&lt;&gt;&#20869;&#12399;&#12487;&#12501;&#12457;&#12523;&#12488;&#20516;)&#65294;
				
				</p><p>user=&lt;username&gt; password=&lt;password&gt;
                dbname=&lt;username&gt; hostname=&lt;server&gt;
                port=&lt;5432&gt;</p><p>
				&#31354;&#12398;&#25509;&#32154;&#25991;&#23383;&#21015;&#12418;&#22949;&#24403;&#12392;&#12373;&#12428;&#12414;&#12377;&#12375;&#65292;&#12354;&#12425;&#12422;&#12427;&#12461;&#12540;&#12392;&#20516;&#12398;&#12506;&#12450;&#12399;&#30465;&#30053;&#12391;&#12365;&#12414;&#12377;&#65294;&#25509;&#32154;&#12377;&#12427;&#12383;&#12417;&#12395;&#12399;&#19968;&#33324;&#30340;&#12395;&#12399;dbname&#12392;username&#12392;&#12364;&#26368;&#23569;&#12391;&#19982;&#12360;&#12427;&#12418;&#12398;&#12392;&#12394;&#12426;&#12414;&#12377;&#65294;
				
				</p></dd><dt><span class="term">DATA</span></dt><dd><p>
				&#12371;&#12398;&#12497;&#12521;&#12513;&#12540;&#12479;&#12398;&#24418;&#24335;&#12399;"&lt;geocolumn&gt; from &lt;tablename&gt; using srid=&lt;srid&gt; using unique &lt;primary key&gt;"&#12391;&#12377;&#65294;&#12371;&#12371;&#12391;&#65292;&#12459;&#12521;&#12512;&#12399;&#22320;&#22259;&#12395;&#25551;&#30011;&#12377;&#12427;&#31354;&#38291;&#12459;&#12521;&#12512;&#12391;&#65292;SRID&#12399;&#65292;&#12459;&#12521;&#12512;&#12364;&#20351;&#29992;&#12377;&#12427;SRID&#12391;&#65292;&#20027;&#12461;&#12540;&#12399;&#12486;&#12540;&#12502;&#12523;&#12398;&#20027;&#12461;&#12540;(&#12414;&#12383;&#12399;&#20182;&#12398;&#65292;&#12452;&#12531;&#12487;&#12463;&#12473;&#12434;&#25345;&#12388;&#12518;&#12491;&#12540;&#12463;&#12394;&#20516;&#12398;&#12459;&#12521;&#12512;)&#12391;&#12377;&#65294;
				
				</p><p>
				"using srid"&#12392;"using unique"&#31680;&#12399;&#30465;&#30053;&#21487;&#33021;&#12391;&#12377;&#65294;
				MapServer&#12399;&#21487;&#33021;&#12394;&#12425;&#33258;&#21205;&#30340;&#12395;&#27491;&#12375;&#12356;&#20516;&#12434;&#27770;&#23450;&#12375;&#12414;&#12377;&#12364;&#65292;&#12510;&#12483;&#12503;&#12434;&#25551;&#30011;&#12377;&#12427;&#12383;&#12403;&#12395;&#12356;&#12367;&#12388;&#12363;&#12398;&#36861;&#21152;&#12463;&#12456;&#12522;&#12434;&#23455;&#34892;&#12377;&#12427;&#12467;&#12473;&#12488;&#12364;&#12363;&#12363;&#12426;&#12414;&#12377;&#65294;
				
				</p></dd><dt><span class="term">PROCESSING</span></dt><dd><p>
				&#25509;&#32154;&#12434;&#38281;&#12376;&#12378;&#12395;&#65292;&#35079;&#25968;&#12398;&#12524;&#12452;&#12516;&#12391;&#20877;&#21033;&#29992;&#12377;&#12427;&#22580;&#21512;&#12395;CLOSE_CONNECTION=DEFER&#12434;&#35373;&#23450;&#12375;&#12414;&#12377;&#65294;&#12371;&#12428;&#12391;&#36895;&#24230;&#12364;&#25913;&#21892;&#12375;&#12414;&#12377;&#65294;&#12424;&#12426;&#35443;&#12375;&#12356;&#35500;&#26126;&#12395;&#12388;&#12356;&#12390;&#12399; <a class="ulink" href="http://blog.cleverelephant.ca/2008/10/mapserverpostgis-performance-tips.html" target="_top">MapServer PostGIS Performance Tips</a> &#12434;&#21442;&#29031;&#12375;&#12390;&#19979;&#12373;&#12356;&#65294;
				
					</p></dd><dt><span class="term">FILTER</span></dt><dd><p>
				&#12501;&#12451;&#12523;&#12479;&#12399;&#65292;&#22949;&#24403;&#12394;SQL&#25991;&#23383;&#21015;&#12391;&#12394;&#12369;&#12428;&#12400;&#12394;&#12426;&#12414;&#12379;&#12435;&#65294;&#26222;&#36890;&#12399;SQL&#12463;&#12456;&#12522;&#20869;&#12391;"WHERE"&#12461;&#12540;&#12527;&#12540;&#12489;&#12395;&#32154;&#12367;&#35542;&#29702;&#24335;&#12395;&#27839;&#12356;&#12414;&#12377;&#65294;&#12383;&#12392;&#12360;&#12400;&#65292;6&#12524;&#12540;&#12531;&#20197;&#19978;&#12398;&#36947;&#36335;&#12398;&#12415;&#12434;&#12524;&#12531;&#12480;&#12522;&#12531;&#12464;&#12377;&#12427;&#12395;&#12399;&#65292;&#12501;&#12451;&#12523;&#12479;&#12434; "num_lanes &gt;= 6" &#12392;&#12375;&#12414;&#12377;&#65294;
				
				</p></dd></dl></div></li><li class="listitem"><p>
		  &#31354;&#38291;&#12487;&#12540;&#12479;&#12505;&#12540;&#12473;&#12395;&#12362;&#12356;&#12390;&#12399;&#65292;&#31354;&#38291;(GiST)&#12452;&#12531;&#12487;&#12463;&#12473;&#12434;&#65292;&#12510;&#12483;&#12503;&#12395;&#25551;&#12363;&#12428;&#12427;&#12524;&#12452;&#12516;&#12540;&#20840;&#12390;&#12395;&#27083;&#31689;&#12375;&#12390;&#12356;&#12427;&#12371;&#12392;&#12434;&#20445;&#35388;&#12375;&#12390;&#19979;&#12373;&#12356;&#65294;
		  
		  </p><pre class="programlisting">CREATE INDEX [&#12452;&#12531;&#12487;&#12463;&#12473;&#21517;] ON [&#12486;&#12540;&#12502;&#12523;&#21517;] USING GIST ( [&#12472;&#12458;&#12513;&#12488;&#12522;&#12459;&#12521;&#12512;&#21517;] );</pre></li><li class="listitem"><p>
		  MapServer&#12434;&#20351;&#29992;&#12377;&#12427;&#12524;&#12452;&#12516;&#12398;&#12463;&#12456;&#12522;&#23455;&#34892;&#12377;&#12427;&#12394;&#12425;&#65292;"using unique"&#31680;&#12418;DATA&#12473;&#12486;&#12540;&#12488;&#12513;&#12531;&#12488;&#12395;&#36861;&#21152;&#12375;&#12394;&#12369;&#12428;&#12400;&#12394;&#12426;&#12414;&#12379;&#12435;&#65294;
		  
		  </p><p>
		  MapServer&#12391;&#12399;&#65292;&#12463;&#12456;&#12522;&#23455;&#34892;&#12398;&#38555;&#12395;&#12399;&#65292;&#12381;&#12428;&#12382;&#12428;&#12398;&#31354;&#38291;&#12524;&#12467;&#12540;&#12489;&#12434;&#35672;&#21029;&#12377;&#12427;&#12383;&#12417;&#12398;&#12518;&#12491;&#12540;&#12463;&#12394;ID&#12364;&#24517;&#35201;&#12391;&#12377;&#65294;MapServer&#12398;PostGIS&#12514;&#12472;&#12517;&#12540;&#12523;&#12399;&#65292;&#12518;&#12491;&#12540;&#12463;&#12394;ID&#12434;&#25552;&#20379;&#12377;&#12427;&#12383;&#12417;&#12395;&#65292;&#12518;&#12540;&#12470;&#25351;&#23450;&#12398;&#12518;&#12491;&#12540;&#12463;&#12394;&#20516;&#12434;&#20351;&#12356;&#12414;&#12377;&#65294;&#12486;&#12540;&#12502;&#12523;&#12398;&#20027;&#12461;&#12540;&#12434;&#20351;&#12358;&#12398;&#12364;&#26368;&#12418;&#33391;&#12356;&#26041;&#27861;&#12391;&#12377;&#65294;
		  
		  </p></li></ol></div></div><div class="sect2" title="5.1.2. &#12424;&#12367;&#12354;&#12427;&#36074;&#21839;"><div class="titlepage"><div><div><h3 class="title"><a name="id286825465"></a>5.1.2. 
	  &#12424;&#12367;&#12354;&#12427;&#36074;&#21839;
	  
	  </h3></div></div></div><div class="qandaset" title="Frequently Asked Questions"><a name="id286825473"></a><dl><dt>5.1.2.1. <a href="ch05.html#id286825475">
			 EXPRESSION&#12434;map&#12501;&#12449;&#12452;&#12523;&#12391;&#20351;&#12358;&#26178;&#12395;&#65292;&#20516;&#12364;&#12486;&#12540;&#12502;&#12523;&#12395;&#12354;&#12427;&#12398;&#12434;&#30906;&#35469;&#12375;&#12390;&#12356;&#12427;&#12398;&#12395;&#26465;&#20214;&#12364;true&#12395;&#12394;&#12426;&#12414;&#12379;&#12435;&#65294;
			
			</a></dt><dt>5.1.2.2. <a href="ch05.html#id286825507">
			&#12471;&#12455;&#12540;&#12503;&#12501;&#12449;&#12452;&#12523;&#12391;&#20351;&#12387;&#12390;&#12356;&#12427;FILTER&#12364;&#65292;&#21516;&#12376;&#12487;&#12540;&#12479;&#12434;&#25345;&#12388;PostGIS&#12486;&#12540;&#12502;&#12523;&#12391;&#12399;&#21205;&#20316;&#12375;&#12414;&#12379;&#12435;&#65294;
			
			</a></dt><dt>5.1.2.3. <a href="ch05.html#id286825531">
			PostGIS&#12524;&#12452;&#12516;&#12398;&#25551;&#30011;&#12364;&#12471;&#12455;&#12540;&#12503;&#12501;&#12449;&#12452;&#12523;&#12424;&#12426;&#36933;&#12367;&#12394;&#12426;&#12414;&#12377;&#12364;&#65292;&#12371;&#12428;&#12364;&#26222;&#36890;&#12394;&#12398;&#12391;&#12375;&#12423;&#12358;&#12363;?
			
			</a></dt><dt>5.1.2.4. <a href="ch05.html#id286825561">
			PostGIS&#12524;&#12452;&#12516;&#12399;&#12385;&#12419;&#12435;&#12392;&#25551;&#12369;&#12414;&#12375;&#12383;&#12364;&#65292;&#12463;&#12456;&#12522;&#12364;&#26412;&#24403;&#12395;&#36933;&#12356;&#12391;&#12377;&#65294;&#20309;&#12364;&#21839;&#38988;&#12394;&#12398;&#12391;&#12377;&#12363;?
			
			</a></dt><dt>5.1.2.5. <a href="ch05.html#id286825633">
			&#12472;&#12458;&#12464;&#12521;&#12501;&#12451;&#12459;&#12521;&#12512;(PostGIS 1.5&#12391;&#27231;&#33021;&#36861;&#21152;)&#12434;MapServer&#12398;&#12524;&#12452;&#12516;&#12398;&#12477;&#12540;&#12473;&#12392;&#12375;&#12390;&#20351;&#29992;&#12391;&#12365;&#12414;&#12377;&#12363;?
			
			</a></dt></dl><table border="0" width="100%" summary="Q and A Set"><col align="left" width="1%"><col><tbody><tr class="question" title="5.1.2.1."><td align="left" valign="top"><a name="id286825475"></a><a name="id286825477"></a><p><b>5.1.2.1.</b></p></td><td align="left" valign="top"><p>
			 <code class="varname">EXPRESSION</code>&#12434;map&#12501;&#12449;&#12452;&#12523;&#12391;&#20351;&#12358;&#26178;&#12395;&#65292;&#20516;&#12364;&#12486;&#12540;&#12502;&#12523;&#12395;&#12354;&#12427;&#12398;&#12434;&#30906;&#35469;&#12375;&#12390;&#12356;&#12427;&#12398;&#12395;&#26465;&#20214;&#12364;true&#12395;&#12394;&#12426;&#12414;&#12379;&#12435;&#65294;
			
			</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
			EXPRESION&#12391;&#20351;&#12358;&#12501;&#12451;&#12540;&#12523;&#12489;&#21517;&#12399;&#65292;&#12471;&#12455;&#12540;&#12503;&#12501;&#12449;&#12452;&#12523;&#12392;&#36949;&#12387;&#12390;PostGIS&#12398;&#22580;&#21512;<span class="emphasis"><em>&#23567;&#25991;&#23383;</em></span>&#12395;&#12394;&#12426;&#12414;&#12377;&#65294;
			
			</p><pre class="programlisting">EXPRESSION ([numlanes] &gt;= 6)</pre></td></tr><tr class="question" title="5.1.2.2."><td align="left" valign="top"><a name="id286825507"></a><a name="id286825509"></a><p><b>5.1.2.2.</b></p></td><td align="left" valign="top"><p>
			&#12471;&#12455;&#12540;&#12503;&#12501;&#12449;&#12452;&#12523;&#12391;&#20351;&#12387;&#12390;&#12356;&#12427;FILTER&#12364;&#65292;&#21516;&#12376;&#12487;&#12540;&#12479;&#12434;&#25345;&#12388;PostGIS&#12486;&#12540;&#12502;&#12523;&#12391;&#12399;&#21205;&#20316;&#12375;&#12414;&#12379;&#12435;&#65294;
			
			</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
			&#12471;&#12455;&#12540;&#12503;&#12501;&#12449;&#12452;&#12523;&#12392;&#36949;&#12356;&#65292; PostGIS&#12524;&#12452;&#12516;&#12398;&#12383;&#12417;&#12398;&#12501;&#12451;&#12523;&#12479;&#12399;&#65292;SQL&#27083;&#25991;&#12434;&#20351;&#12356;&#12414;&#12377;(PostGIS&#12467;&#12493;&#12463;&#12479;&#12364;Mapserver&#12391;&#12524;&#12452;&#12516;&#12434;&#25551;&#30011;&#12377;&#12427;&#12383;&#12417;&#12395;&#29983;&#25104;&#12377;&#12427;SQL&#12473;&#12486;&#12540;&#12488;&#12513;&#12531;&#12488;&#12395;&#36861;&#21152;&#12373;&#12428;&#12414;&#12377;)&#65294;
			
			</p><pre class="programlisting">FILTER "type = 'highway' and numlanes &gt;= 4"</pre></td></tr><tr class="question" title="5.1.2.3."><td align="left" valign="top"><a name="id286825531"></a><a name="id286825533"></a><p><b>5.1.2.3.</b></p></td><td align="left" valign="top"><p>
			PostGIS&#12524;&#12452;&#12516;&#12398;&#25551;&#30011;&#12364;&#12471;&#12455;&#12540;&#12503;&#12501;&#12449;&#12452;&#12523;&#12424;&#12426;&#36933;&#12367;&#12394;&#12426;&#12414;&#12377;&#12364;&#65292;&#12371;&#12428;&#12364;&#26222;&#36890;&#12394;&#12398;&#12391;&#12375;&#12423;&#12358;&#12363;?
			
			</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
			&#19968;&#33324;&#30340;&#12395;&#65292;&#22320;&#22259;&#12395;&#25551;&#30011;&#12373;&#12428;&#12427;&#12501;&#12451;&#12540;&#12481;&#12515;&#12540;&#12364;&#22810;&#12367;&#12394;&#12427;&#12392;&#65292;PostGIS&#12399;&#12471;&#12455;&#12540;&#12503;&#12501;&#12449;&#12452;&#12523;&#12424;&#12426;&#36933;&#12367;&#12394;&#12426;&#12414;&#12377;&#65294;&#27604;&#36611;&#30340;&#23569;&#12394;&#12356;&#12501;&#12451;&#12540;&#12481;&#12515;&#12540;(100&#21488;)&#12391;&#12399;PostGIS&#12398;&#26041;&#12364;&#26089;&#12367;&#65292;&#12501;&#12451;&#12540;&#12481;&#12515;&#12540;&#23494;&#24230;&#12364;&#39640;&#12367;&#12394;&#12427;(1000&#21488;)&#12392;&#65292;PostGIS&#12398;&#26041;&#12364;&#36933;&#12367;&#12394;&#12426;&#12414;&#12377;&#65294;
			
            </p><p>
			&#37325;&#22823;&#12394;&#25551;&#30011;&#24615;&#33021;&#12398;&#21839;&#38988;&#12364;&#12354;&#12427;&#12424;&#12358;&#12391;&#12375;&#12383;&#12425;&#65292;&#12486;&#12540;&#12502;&#12523;&#12395;&#12354;&#12427;&#31354;&#38291;&#12452;&#12531;&#12487;&#12463;&#12473;&#12434;&#27083;&#31689;&#12375;&#12390;&#12356;&#12394;&#12356;&#12392;&#12356;&#12358;&#12398;&#12364;&#12354;&#12426;&#12381;&#12358;&#12391;&#12377;&#65294;
			
			</p><pre class="programlisting">postgis# CREATE INDEX geotable_gix ON geotable USING GIST ( geocolumn ); 
postgis# VACUUM ANALYZE;</pre></td></tr><tr class="question" title="5.1.2.4."><td align="left" valign="top"><a name="id286825561"></a><a name="id286825563"></a><p><b>5.1.2.4.</b></p></td><td align="left" valign="top"><p>
			PostGIS&#12524;&#12452;&#12516;&#12399;&#12385;&#12419;&#12435;&#12392;&#25551;&#12369;&#12414;&#12375;&#12383;&#12364;&#65292;&#12463;&#12456;&#12522;&#12364;&#26412;&#24403;&#12395;&#36933;&#12356;&#12391;&#12377;&#65294;&#20309;&#12364;&#21839;&#38988;&#12394;&#12398;&#12391;&#12377;&#12363;?
			
			</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
			&#12463;&#12456;&#12522;&#12434;&#26089;&#12367;&#12377;&#12427;&#12395;&#12399;&#65292;&#31354;&#38291;&#12486;&#12540;&#12502;&#12523;&#12395;&#19968;&#24847;&#12394;&#12461;&#12540;&#12434;&#25345;&#12383;&#12379;&#65292;&#12381;&#12398;&#12461;&#12540;&#12395;&#12452;&#12531;&#12487;&#12463;&#12473;&#12434;&#25345;&#12383;&#12379;&#12394;&#12369;&#12428;&#12400;&#12394;&#12426;&#12414;&#12379;&#12435;&#65294;
			
			</p><p>
			 <code class="varname">DATA</code>&#34892;&#12398;<code class="varname">USING UNIQUE</code>&#31680;&#12391;&#65292;MapServer&#12391;&#20351;&#29992;&#12377;&#12427;&#19968;&#24847;&#12394;&#12461;&#12540;&#12434;&#12393;&#12428;&#12395;&#12377;&#12427;&#12363;&#25351;&#23450;&#12377;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12414;&#12377;&#65294;
			
			</p><pre class="programlisting">DATA "the_geom FROM geotable USING UNIQUE gid"</pre></td></tr><tr class="question" title="5.1.2.5."><td align="left" valign="top"><a name="id286825633"></a><a name="id286825635"></a><p><b>5.1.2.5.</b></p></td><td align="left" valign="top"><p>
			&#12472;&#12458;&#12464;&#12521;&#12501;&#12451;&#12459;&#12521;&#12512;(PostGIS 1.5&#12391;&#27231;&#33021;&#36861;&#21152;)&#12434;MapServer&#12398;&#12524;&#12452;&#12516;&#12398;&#12477;&#12540;&#12473;&#12392;&#12375;&#12390;&#20351;&#29992;&#12391;&#12365;&#12414;&#12377;&#12363;?
			
			</p></td></tr><tr class="answer"><td align="left" valign="top"></td><td align="left" valign="top"><p>
			&#12391;&#12365;&#12414;&#12377;!MapServer&#12399;&#12472;&#12458;&#12464;&#12521;&#12501;&#12451;&#12459;&#12521;&#12512;&#12434;&#12472;&#12458;&#12513;&#12488;&#12522;&#12459;&#12521;&#12512;&#12392;&#21516;&#12376;&#12395;&#35469;&#35672;&#12375;&#12414;&#12377;&#65294;
			&#12375;&#12363;&#12375;&#65292;&#24120;&#12395;SRID&#12434;4326&#12392;&#12375;&#12414;&#12377;&#65294;
			"using srid=43426"&#31680;&#12434;<code class="varname">DATA</code>&#12473;&#12486;&#12540;&#12488;&#12513;&#12531;&#12488;&#12395;&#20837;&#12428;&#12390;&#19979;&#12373;&#12356;&#65294;
			&#20182;&#12398;&#37096;&#20998;&#12399;&#12472;&#12458;&#12513;&#12488;&#12522;&#12398;&#22580;&#21512;&#12392;&#21516;&#12376;&#12391;&#12377;&#65294;
			
			</p><pre class="programlisting">DATA "the_geog FROM geogtable USING SRID=4326 USING UNIQUE gid"</pre></td></tr></tbody></table></div></div><div class="sect2" title="5.1.3. &#36367;&#12415;&#36796;&#12435;&#12384;&#20351;&#29992;&#27861;"><div class="titlepage"><div><div><h3 class="title"><a name="id286825662"></a>5.1.3. 
	  &#36367;&#12415;&#36796;&#12435;&#12384;&#20351;&#29992;&#27861;
	  
	  </h3></div></div></div><p>
	  USING&#30097;&#20284;SQL&#31680;&#12434;&#20351;&#12387;&#12390;MapServer&#12364;&#12424;&#12426;&#35079;&#38609;&#12394;&#12463;&#12456;&#12522;&#12398;&#32080;&#26524;&#12434;&#29702;&#35299;&#12391;&#12365;&#12427;&#12424;&#12358;&#12395;&#12377;&#12427;&#12383;&#12417;&#12398;&#24773;&#22577;&#12434;&#36861;&#21152;&#12375;&#12414;&#12377;&#65294;&#12424;&#12426;&#35443;&#12375;&#12367;&#35328;&#12358;&#12392;&#65292;&#12499;&#12517;&#12540;&#12414;&#12383;&#12399;&#21103;&#21839;&#12356;&#21512;&#12431;&#12379;&#12364;&#20803;&#12486;&#12540;&#12502;&#12523;(<code class="varname">DATA</code>&#23450;&#32681;&#12391;"FROM"&#12398;&#21491;&#12395;&#12354;&#12427;&#12418;&#12398;)&#12392;&#12375;&#12390;&#20351;&#12431;&#12428;&#12427;&#26178;&#65292; MapServer&#12364;&#33258;&#21205;&#30340;&#12395;&#19968;&#24847;&#12394;&#35672;&#21029;&#23376;&#12364;&#12381;&#12428;&#12382;&#12428;&#12398;&#34892;&#12395;&#12354;&#12427;&#12363;&#65292;&#12414;&#12383;&#65292;SRID&#12364;&#12486;&#12540;&#12502;&#12523;&#12395;&#12354;&#12427;&#12363;&#12434;&#21028;&#21029;&#12377;&#12427;&#12398;&#12399;&#22256;&#38627;&#12391;&#12377;&#65294; <code class="varname">USING</code>&#31680;&#12395;&#12424;&#12387;&#12390;&#65292;MapServer&#12364;&#12371;&#12428;&#12425;&#12398;&#24773;&#22577;&#12434;&#24471;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12414;&#12377;&#65294;&#20363;&#12434;&#27425;&#12395;&#25369;&#12370;&#12414;&#12377;&#65294;
	  
	  </p><pre class="programlisting">DATA "the_geom FROM (
  SELECT 
    table1.the_geom AS the_geom, 
    table1.oid AS oid, 
    table2.data AS data 
  FROM table1 
  LEFT JOIN table2 
  ON table1.id = table2.id
) AS new_table USING UNIQUE gid USING SRID=-1"</pre><div class="variablelist"><dl><dt><span class="term">USING UNIQUE &lt;uniqueid&gt;</span></dt><dd><p>
			Mapserver&#12399;&#65292;&#12510;&#12483;&#12503;&#12463;&#12456;&#12522;&#12434;&#23455;&#34892;&#12377;&#12427;&#38555;&#65292;&#34892;&#35672;&#21029;&#12398;&#12383;&#12417;&#12395;&#65292;&#12381;&#12428;&#12382;&#12428;&#12398;&#34892;&#12395;&#19968;&#24847;&#12394;&#35672;&#21029;&#23376;&#12434;&#27714;&#12417;&#12414;&#12377;&#65294;&#36890;&#24120;&#12394;&#12425;&#12471;&#12473;&#12486;&#12512;&#12486;&#12540;&#12502;&#12523;&#12363;&#12425;&#20027;&#12461;&#12540;&#12434;&#35672;&#21029;&#12375;&#12414;&#12377;&#12364;&#65292;&#12499;&#12517;&#12540;&#12420;&#21103;&#21839;&#12356;&#21512;&#12431;&#12379;&#12391;&#12399;&#65292;&#12518;&#12491;&#12540;&#12463;&#12394;&#12459;&#12521;&#12512;&#12434;&#33258;&#21205;&#30340;&#12395;&#30693;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12414;&#12379;&#12435;&#65294; MapServer&#12398;&#12463;&#12456;&#12522;&#27231;&#33021;&#12434;&#20351;&#12356;&#12383;&#12356;&#12394;&#12425;&#65292;&#12518;&#12491;&#12540;&#12463;&#12394;&#12459;&#12521;&#12512;&#12434;&#12499;&#12517;&#12540;&#12414;&#12383;&#12399;&#21103;&#21839;&#12356;&#21512;&#12431;&#12379;&#12395;&#36861;&#21152;&#12377;&#12427;&#24517;&#35201;&#12364;&#12354;&#12426;&#65292;&#12381;&#12398;&#12459;&#12521;&#12512;&#12395;<code class="varname">USING UNIQUE</code>&#23459;&#35328;&#12434;&#20184;&#12369;&#12427;&#24517;&#35201;&#12364;&#12354;&#12426;&#12414;&#12377;&#65294;&#12383;&#12392;&#12360;&#12400;&#65292;&#12371;&#12398;&#30446;&#30340;&#12398;&#12383;&#12417;&#12398;&#20027;&#12461;&#12540;&#20516;&#12398;&#12486;&#12540;&#12502;&#12523;&#12391;&#12398;&#12459;&#12521;&#12512;&#21517;&#12420;&#65292;&#32080;&#26524;&#12475;&#12483;&#12488;&#12391;&#12518;&#12491;&#12540;&#12463;&#24615;&#12364;&#20445;&#38556;&#12373;&#12428;&#12383;&#12459;&#12521;&#12512;&#12434;&#26126;&#31034;&#30340;&#12395;SELECT&#12395;&#20837;&#12428;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12414;&#12377;&#65294;
			
			</p><div class="note" title="&#27880;&#24847;" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[&#27880;&#24847;]" src="images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
			  &#12300;&#12510;&#12483;&#12503;&#12463;&#12456;&#12522;&#12301;&#12399;&#12483;&#12503;&#19978;&#12391;&#12463;&#12522;&#12483;&#12463;&#12375;&#12390;&#65292;&#12381;&#12398;&#22580;&#25152;&#12395;&#12362;&#12369;&#12427;&#12501;&#12451;&#12540;&#12481;&#12515;&#12540;&#12395;&#38306;&#12377;&#12427;&#24773;&#22577;&#12434;&#21839;&#12356;&#21512;&#12431;&#12379;&#12427;&#21205;&#20316;&#12391;&#12377;&#65294;&#12300;&#12510;&#12483;&#12503;&#12463;&#12456;&#12522;&#12301;&#12392;<code class="varname">DATA</code>&#23450;&#32681;&#12395;&#12362;&#12369;&#12427;SQL&#12463;&#12456;&#12522;&#12392;&#28151;&#21516;&#12375;&#12394;&#12356;&#12391;&#19979;&#12373;&#12356;&#65294; 
			  
			  </p></td></tr></table></div></dd><dt><span class="term">USING SRID=&lt;srid&gt;</span></dt><dd><p>
			PostGIS&#12399;&#65292; MapServer&#12395;&#27491;&#12375;&#12356;&#12487;&#12540;&#12479;&#12434;&#36820;&#12377;&#12383;&#12417;&#12395;&#65292;&#12472;&#12458;&#12513;&#12488;&#12522;&#12364;&#12393;&#12398;&#31354;&#38291;&#21442;&#29031;&#31995;&#12434;&#20351;&#12387;&#12390;&#12356;&#12427;&#12363;&#12434;&#30693;&#12427;&#24517;&#35201;&#12364;&#12354;&#12426;&#12414;&#12377;&#65294;&#36890;&#24120;&#12399;&#65292;&#12371;&#12398;&#24773;&#22577;&#12399;PostGIS&#12487;&#12540;&#12479;&#12505;&#12540;&#12473;&#12398;&#12300;geometry_columns&#12301;&#12486;&#12540;&#12502;&#12523;&#12363;&#12425;&#24471;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12414;&#12377;&#65294;&#12375;&#12363;&#12375;&#65292;&#21103;&#21839;&#12356;&#21512;&#12431;&#12379;&#12420;&#12499;&#12517;&#12540;&#12398;&#12424;&#12358;&#12394;&#19968;&#26178;&#12486;&#12540;&#12502;&#12523;&#12391;&#12399;&#65292;&#12371;&#12398;&#26041;&#27861;&#12399;&#19981;&#21487;&#33021;&#12391;&#12377;&#65294;&#12381;&#12371;&#12391;&#65292;<code class="varname">USING SRID=</code>&#12458;&#12503;&#12471;&#12519;&#12531;&#12434;&#20351;&#12387;&#12390;&#65292;&#27491;&#12375;&#12356;SRID&#12364;<code class="varname">DATA</code>&#23450;&#32681;&#12391;&#20351;&#12431;&#12428;&#12427;&#12424;&#12358;&#12395;&#25351;&#23450;&#12375;&#12414;&#12377;&#65294;
			
			</p></dd></dl></div></div><div class="sect2" title="5.1.4. &#20363;"><div class="titlepage"><div><div><h3 class="title"><a name="id286825778"></a>5.1.4. 
	  &#20363;
	  
	  </h3></div></div></div><p>
	  &#31777;&#21336;&#12394;&#20363;&#12363;&#12425;&#22987;&#12417;&#12390;&#65292;&#12473;&#12486;&#12483;&#12503;&#12450;&#12483;&#12503;&#12375;&#12390;&#12356;&#12365;&#12414;&#12375;&#12423;&#12358;&#65294;&#27425;&#12398;MapServer&#12524;&#12452;&#12516;&#23450;&#32681;&#12434;&#32771;&#12360;&#12390;&#19979;&#12373;&#12356;&#65294;
	  
	  </p><pre class="programlisting">LAYER 
  CONNECTIONTYPE postgis 
  NAME "roads"
  CONNECTION "user=theuser password=thepass dbname=thedb host=theserver" 
  DATA "the_geom from roads" 
  STATUS ON 
  TYPE LINE 
  CLASS 
    STYLE
      COLOR 0 0 0 
    END
  END 
END</pre><p>
	  &#12371;&#12398;&#12524;&#12452;&#12516;&#12399;"roads"&#12486;&#12540;&#12502;&#12523;&#12395;&#12354;&#12427;&#36947;&#36335;&#12472;&#12458;&#12513;&#12488;&#12522;&#12398;&#20840;&#37096;&#12434;&#40658;&#32218;&#12391;&#34920;&#31034;&#12377;&#12427;&#12418;&#12398;&#12391;&#12377;&#65294;
	  
	  </p><p>
	  &#12391;&#12399;&#65292;&#23569;&#12394;&#12367;&#12392;&#12418;1:100000&#12395;&#12474;&#12540;&#12512;&#12377;&#12427;&#12414;&#12391;&#12399;&#39640;&#36895;&#36947;&#36335;&#12384;&#12369;&#12434;&#34920;&#31034;&#12375;&#12383;&#12356;&#65292;&#12392;&#35328;&#12387;&#12390;&#12415;&#12414;&#12375;&#12423;&#12358;&#65294;&#27425;&#12398;&#20108;&#12388;&#12398;&#12524;&#12452;&#12516;&#12391;&#65292;&#12381;&#12398;&#21177;&#26524;&#12364;&#23455;&#29694;&#12391;&#12365;&#12414;&#12377;&#65294;
	  
	  </p><pre class="programlisting">LAYER 
  CONNECTIONTYPE postgis 
  CONNECTION "user=theuser password=thepass dbname=thedb host=theserver" 
  PROCESSING "CLOSE_CONNECTION=DEFER"
  DATA "the_geom from roads"
  MINSCALE 100000 
  STATUS ON 
  TYPE LINE 
  FILTER "road_type = 'highway'" 
  CLASS 
    COLOR 0 0 0 
  END 
END 
LAYER 
  CONNECTIONTYPE postgis 
  CONNECTION "user=theuser password=thepass dbname=thedb host=theserver"
  PROCESSING "CLOSE_CONNECTION=DEFER"
  DATA "the_geom from roads" 
  MAXSCALE 100000 
  STATUS ON 
  TYPE LINE
  CLASSITEM road_type 
  CLASS 
    EXPRESSION "highway" 
    STYLE
      WIDTH 2 
      COLOR 255 0 0  
    END
  END 
  CLASS  
    STYLE
      COLOR 0 0 0 
    END
  END 
END</pre><p>
	  &#19968;&#12388;&#30446;&#12398;&#12524;&#12452;&#12516;&#12399;&#12473;&#12465;&#12540;&#12523;&#12364;1:100000&#20197;&#19978;&#12391;&#12354;&#12427;&#12392;&#12365;&#12395;&#20351;&#12431;&#12428;&#65292;&#36947;&#36335;&#12479;&#12452;&#12503;&#12364;"highway"&#12391;&#12354;&#12427;&#36947;&#36335;&#12398;&#12415;&#40658;&#32218;&#12391;&#34920;&#31034;&#12373;&#12428;&#12414;&#12377;&#65294;<code class="varname">FILTER</code>&#12458;&#12503;&#12471;&#12519;&#12531;&#12395;&#12424;&#12387;&#12390;&#65292;&#36947;&#36335;&#12479;&#12452;&#12503;&#12364;"highway"&#12398;&#22580;&#21512;&#12398;&#12415;&#34920;&#31034;&#12377;&#12427;&#12371;&#12392;&#12395;&#12394;&#12426;&#12414;&#12377;&#65294;
	  
	  </p><p>
	  &#20108;&#12388;&#30446;&#12398;&#12524;&#12452;&#12516;&#12399;&#12473;&#12465;&#12540;&#12523;&#12364;1:100000&#26410;&#28288;&#12391;&#12354;&#12427;&#26178;&#12395;&#20351;&#12431;&#12428;&#65292;"highway"&#12399;&#36196;&#12356;&#20108;&#37325;&#32048;&#32218;&#12391;&#34920;&#31034;&#12373;&#12428;&#65292;&#20182;&#12398;&#36947;&#36335;&#12399;&#40658;&#32218;&#12391;&#34920;&#31034;&#12373;&#12428;&#12414;&#12377;&#65294;
	  
	  </p><p>
	  &#12373;&#12390;&#65292;Mapserver&#12398;&#27231;&#33021;&#12434;&#20351;&#12358;&#12384;&#12369;&#12391;&#65292;&#20108;&#12388;&#12398;&#12362;&#12418;&#12375;&#12429;&#12356;&#12371;&#12392;&#12434;&#23455;&#34892;&#12375;&#12414;&#12375;&#12383;&#65294;&#12375;&#12363;&#12375;&#65292;<code class="varname">DATA</code>&#12398;SQL&#12473;&#12486;&#12540;&#12488;&#12513;&#12531;&#12488;&#12399;&#65292;&#21336;&#32020;&#12394;&#12414;&#12414;&#12391;&#12377;&#65294;&#36947;&#36335;&#21517;&#12364;(&#12393;&#12358;&#12356;&#12358;&#29702;&#30001;&#12363;&#12399;&#30693;&#12426;&#12414;&#12379;&#12435;&#12364;)&#20182;&#12398;&#12486;&#12540;&#12502;&#12523;&#12395;&#21454;&#12417;&#12425;&#12428;&#12390;&#12356;&#12390;&#65292;&#12381;&#12428;&#12398;&#12487;&#12540;&#12479;&#12434;&#21462;&#24471;&#12377;&#12427;&#12383;&#12417;&#12395;&#12486;&#12540;&#12502;&#12523;&#12434;&#25509;&#32154;&#12375;&#12390;&#65292;&#36947;&#36335;&#12398;&#12521;&#12505;&#12523;&#12434;&#21462;&#12427;&#24517;&#35201;&#12364;&#12354;&#12427;&#65292;&#12392;&#12375;&#12414;&#12377;&#65294;
	  
	  </p><pre class="programlisting">LAYER 
  CONNECTIONTYPE postgis
  CONNECTION "user=theuser password=thepass dbname=thedb host=theserver" 
  DATA "the_geom FROM (SELECT roads.oid AS oid, roads.the_geom AS the_geom, 
        road_names.name as name FROM roads LEFT JOIN road_names ON 
        roads.road_name_id = road_names.road_name_id) 
        AS named_roads USING UNIQUE oid USING SRID=-1" 
  MAXSCALE 20000 
  STATUS ON 
  TYPE ANNOTATION 
  LABELITEM name
  CLASS 
    LABEL 
      ANGLE auto 
      SIZE 8 
      COLOR 0 192 0 
      TYPE truetype 
      FONT arial
    END
  END 
END</pre><p>
	  &#12371;&#12398;ANNOTAION&#12524;&#12452;&#12516;&#12391;&#12399;&#65292;&#32302;&#23610;&#12364;1:20000&#20197;&#19979;&#12398;&#12392;&#12365;&#12395;&#65292;&#20840;&#12390;&#12398;&#36947;&#36335;&#12395;&#32209;&#33394;&#12398;&#12521;&#12505;&#12523;&#12434;&#34920;&#31034;&#12375;&#12414;&#12377;&#65294;&#12414;&#12383;&#65292;&#12371;&#12398;&#20363;&#12399;&#65292;<code class="varname">DATA</code>&#23450;&#32681;&#12391;&#65292;SQL&#12398;JOIN&#12434;&#20351;&#29992;&#12377;&#12427;&#26041;&#27861;&#12418;&#31034;&#12375;&#12390;&#12356;&#12414;&#12377;&#65294; 
	  
	  </p></div></div><div class="sect1" title="5.2. Java&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;(JDBC)"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id286826022"></a>5.2. 
	Java&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;(JDBC)
	
	</h2></div></div></div><p>
	Java&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;&#12399;&#65292;&#30452;&#25509;&#30340;&#12395;&#12486;&#12461;&#12473;&#12488;&#34920;&#29694;&#12392;&#12375;&#12390;&#65292;&#12414;&#12383;&#12399;PostGIS&#12395;&#12496;&#12531;&#12489;&#12523;&#12373;&#12428;&#12390;&#12356;&#12427;JDBC&#25313;&#24373;&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;&#12434;&#20351;&#29992;&#12375;&#12390;&#65292;PostgreSQL&#12487;&#12540;&#12479;&#12505;&#12540;&#12473;&#20869;&#12395;&#12354;&#12427;&#65292;PostGIS&#12398;"geometry"&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;&#12395;&#12450;&#12463;&#12475;&#12473;&#12391;&#12365;&#12414;&#12377;&#65294;&#25313;&#24373;&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;&#12434;&#20351;&#12358;&#12383;&#12417;&#12395;&#12399;&#65292;"postgis.jar"&#12501;&#12449;&#12452;&#12523;&#12434;&#65292;JDBC&#12489;&#12521;&#12452;&#12496;&#12497;&#12483;&#12465;&#12540;&#12472;&#12398;"postgresql.jar"&#12392;&#12392;&#12418;&#12395;&#65292; CLASSPATH&#12395;&#32622;&#12367;&#24517;&#35201;&#12364;&#12354;&#12426;&#12414;&#12377;&#65294;
	
	</p><pre class="programlisting">import java.sql.*; 
import java.util.*; 
import java.lang.*; 
import org.postgis.*; 

public class JavaGIS { 

public static void main(String[] args) { 

  java.sql.Connection conn; 

  try { 
    /* 
    * JDBC&#12489;&#12521;&#12452;&#12496;&#12434;&#12525;&#12540;&#12489;&#12375;&#12390;&#25509;&#32154;&#12434;&#30906;&#31435;&#12375;&#12414;&#12377;
    */
    Class.forName("org.postgresql.Driver"); 
    String url = "jdbc:postgresql://localhost:5432/database"; 
    conn = DriverManager.getConnection(url, "postgres", ""); 
    /* 
    * &#12472;&#12458;&#12513;&#12488;&#12522;&#22411;&#12434;&#25509;&#32154;&#12395;&#36861;&#21152;&#12375;&#12414;&#12377;
    * &#12372;&#27880;&#24847; : addDateType()&#12434;&#21628;&#12406;&#21069;&#12395;
    *   &#25509;&#32154;&#12434;pgsql&#29305;&#26377;&#12398;&#25509;&#32154;&#23455;&#35013;&#12395;&#12461;&#12515;&#12473;&#12488;&#12375;&#12394;&#12369;&#12428;&#12400;&#12394;&#12426;&#12414;&#12379;&#12435;
    */
    ((org.postgresql.Connection)conn).addDataType("geometry","org.postgis.PGgeometry")
;
    ((org.postgresql.Connection)conn).addDataType("box3d","org.postgis.PGbox3d");
    /* 
    * Create a statement and execute a select query. 
    */ 
    Statement s = conn.createStatement(); 
    ResultSet r = s.executeQuery("select ST_AsText(geom) as geom,id from geomtable"); 
    while( r.next() ) { 
      /* 
      * Retrieve the geometry as an object then cast it to the geometry type. 
      * Print things out. 
      */ 
      PGgeometry geom = (PGgeometry)r.getObject(1); 
      int id = r.getInt(2); 
      System.out.println("Row " + id + ":");
      System.out.println(geom.toString()); 
    } 
    s.close(); 
    conn.close(); 
  } 
catch( Exception e ) { 
  e.printStackTrace(); 
  } 
} 
}</pre><p>
	"PGeometry"&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;&#12399;&#65292; Point, LineString, Polygon, MultiPoint, MultiLineString, MultiPolygon &#12398;&#21508;&#22411;&#12395;&#20381;&#23384;&#12377;&#12427;&#65292;&#29305;&#23450;&#12398;&#12488;&#12509;&#12525;&#12472;&#12459;&#12523;&#12472;&#12458;&#12513;&#12488;&#12522;&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;("Geometory"&#25277;&#35937;&#12463;&#12521;&#12473;&#12398;&#23376;&#12463;&#12521;&#12473;)&#12434;&#25345;&#12388;&#12521;&#12483;&#12497;&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;&#12391;&#12377;&#65294; 
	
	</p><pre class="programlisting">PGgeometry geom = (PGgeometry)r.getObject(1); 
if( geom.getType() = Geometry.POLYGON ) { 
  Polygon pl = (Polygon)geom.getGeometry(); 
  for( int r = 0; r &lt; pl.numRings(); r++) { 
    LinearRing rng = pl.getRing(r); 
    System.out.println("Ring: " + r); 
    for( int p = 0; p &lt; rng.numPoints(); p++ ) { 
      Point pt = rng.getPoint(p); 
      System.out.println("Point: " + p);
      System.out.println(pt.toString()); 
    } 
  } 
}</pre><p>
	&#24190;&#20309;&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;&#12398;&#12373;&#12414;&#12374;&#12414;&#12394;&#12487;&#12540;&#12479;&#12450;&#12463;&#12475;&#12469;&#38306;&#25968;&#12395;&#38306;&#12377;&#12427;&#21442;&#29031;&#24773;&#22577;&#12395;&#12388;&#12356;&#12390;&#12399;&#65292;&#25313;&#24373;&#12458;&#12502;&#12472;&#12455;&#12463;&#12488;&#12398;JavaDoc&#12434;&#12372;&#35239;&#19979;&#12373;&#12356;&#65294;
	
	</p></div><div class="sect1" title="5.3. C&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;(libpq)"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="id286826057"></a>5.3. 
	C&#12463;&#12521;&#12452;&#12450;&#12531;&#12488;(libpq)
	
	</h2></div></div></div><div class="toc"><dl><dt><span class="sect2"><a href="ch05.html#id286826068">5.3.1. 
	  &#12486;&#12461;&#12473;&#12488;&#12459;&#12540;&#12477;&#12523;
	  
	  </a></span></dt><dt><span class="sect2"><a href="ch05.html#id286826080">5.3.2. 
	  &#12496;&#12452;&#12490;&#12522;&#12459;&#12540;&#12477;&#12523;
	  
	  </a></span></dt></dl></div><p>...</p><div class="sect2" title="5.3.1. &#12486;&#12461;&#12473;&#12488;&#12459;&#12540;&#12477;&#12523;"><div class="titlepage"><div><div><h3 class="title"><a name="id286826068"></a>5.3.1. 
	  &#12486;&#12461;&#12473;&#12488;&#12459;&#12540;&#12477;&#12523;
	  
	  </h3></div></div></div><p>...</p></div><div class="sect2" title="5.3.2. &#12496;&#12452;&#12490;&#12522;&#12459;&#12540;&#12477;&#12523;"><div class="titlepage"><div><div><h3 class="title"><a name="id286826080"></a>5.3.2. 
	  &#12496;&#12452;&#12490;&#12522;&#12459;&#12540;&#12477;&#12523;
	  
	  </h3></div></div></div><p>...</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ch04.html">&#21069;&#12398;&#12506;&#12540;&#12472;</a> </td><td width="20%" align="center"> </td><td width="40%" align="right"> <a accesskey="n" href="ch06.html">&#27425;&#12398;&#12506;&#12540;&#12472;</a></td></tr><tr><td width="40%" align="left" valign="top">&#31532;4&#31456; 
  PostGIS&#12434;&#20351;&#12358;: &#12487;&#12540;&#12479;&#31649;&#29702;&#12392;&#12463;&#12456;&#12522;
  
   </td><td width="20%" align="center"><a accesskey="h" href="index.html">&#12507;&#12540;&#12512;</a></td><td width="40%" align="right" valign="top"> &#31532;6&#31456; 
  &#24615;&#33021;&#21521;&#19978;&#12395;&#38306;&#12377;&#12427;&#25216;&#27861;
  
  </td></tr></table></div></body></html>
